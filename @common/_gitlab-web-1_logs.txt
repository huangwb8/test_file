gitlab-web-1  | Thank you for using GitLab Docker Image!
gitlab-web-1  | Current version: gitlab-ce=14.10.5-ce.0
gitlab-web-1  |
gitlab-web-1  | Configure GitLab for your system by editing /etc/gitlab/gitlab.rb file
gitlab-web-1  | And restart this container to reload settings.
gitlab-web-1  | To do it use docker exec:
gitlab-web-1  |
gitlab-web-1  |   docker exec -it gitlab editor /etc/gitlab/gitlab.rb
gitlab-web-1  |   docker restart gitlab
gitlab-web-1  |
gitlab-web-1  | For a comprehensive list of configuration options please see the Omnibus GitLab readme
gitlab-web-1  | https://gitlab.com/gitlab-org/omnibus-gitlab/blob/master/README.md
gitlab-web-1  |
gitlab-web-1  | If this container fails to start due to permission problems try to fix it by executing:
gitlab-web-1  |
gitlab-web-1  |   docker exec -it gitlab update-permissions
gitlab-web-1  |   docker restart gitlab
gitlab-web-1  |
gitlab-web-1  | Cleaning stale PIDs & sockets
gitlab-web-1  | cat: /var/opt/gitlab/gitlab-rails/VERSION: No such file or directory
gitlab-web-1  | Installing gitlab.rb config...
gitlab-web-1  | Generating ssh_host_rsa_key...
gitlab-web-1  | Generating public/private rsa key pair.
gitlab-web-1  | Your identification has been saved in /etc/gitlab/ssh_host_rsa_key
gitlab-web-1  | Your public key has been saved in /etc/gitlab/ssh_host_rsa_key.pub
gitlab-web-1  | The key fingerprint is:
gitlab-web-1  | SHA256:bU0M1/hxwjnMsj+9XBU5aMQ5BABXIxxRrgQwoskYVSs root@gitlab.example.com
gitlab-web-1  | The key's randomart image is:
gitlab-web-1  | +---[RSA 3072]----+
gitlab-web-1  | |...o.o.oo*B=*Oo..|
gitlab-web-1  | |o.o ... o.o++*X+.|
gitlab-web-1  | |.+E .    . .++.=o|
gitlab-web-1  | |   .    ...o. . .|
gitlab-web-1  | |        S.o .. ..|
gitlab-web-1  | |         .    o o|
gitlab-web-1  | |              ..o|
gitlab-web-1  | |               o |
gitlab-web-1  | |                 |
gitlab-web-1  | +----[SHA256]-----+
gitlab-web-1  | Generating ssh_host_ecdsa_key...
gitlab-web-1  | Generating public/private ecdsa key pair.
gitlab-web-1  | Your identification has been saved in /etc/gitlab/ssh_host_ecdsa_key
gitlab-web-1  | Your public key has been saved in /etc/gitlab/ssh_host_ecdsa_key.pub
gitlab-web-1  | The key fingerprint is:
gitlab-web-1  | SHA256:INK8FZxXeQITjOTCBGYRCVHbvg0A+X8DioS2/u5gkp4 root@gitlab.example.com
gitlab-web-1  | The key's randomart image is:
gitlab-web-1  | +---[ECDSA 256]---+
gitlab-web-1  | |+=B=.oo+++..     |
gitlab-web-1  | |.+.B .+.o.o .    |
gitlab-web-1  | |..+ B +.   o     |
gitlab-web-1  | |.o.+.= .         |
gitlab-web-1  | |o..o+.  S        |
gitlab-web-1  | |.o. .+o          |
gitlab-web-1  | |+o  ....         |
gitlab-web-1  | |+.o              |
gitlab-web-1  | | E++             |
gitlab-web-1  | +----[SHA256]-----+
gitlab-web-1  | Generating ssh_host_ed25519_key...
gitlab-web-1  | Generating public/private ed25519 key pair.
gitlab-web-1  | Your identification has been saved in /etc/gitlab/ssh_host_ed25519_key
gitlab-web-1  | Your public key has been saved in /etc/gitlab/ssh_host_ed25519_key.pub
gitlab-web-1  | The key fingerprint is:
gitlab-web-1  | SHA256:qDCtQ89sOSJ6ALZVqw+mMnHg+vxefiSz+WGilyd7m/M root@gitlab.example.com
gitlab-web-1  | The key's randomart image is:
gitlab-web-1  | +--[ED25519 256]--+
gitlab-web-1  | |                 |
gitlab-web-1  | |     .           |
gitlab-web-1  | |    . .          |
gitlab-web-1  | |o. o . .         |
gitlab-web-1  | |+.* o . S        |
gitlab-web-1  | |o+.@ oo .        |
gitlab-web-1  | |o+* @ oBo        |
gitlab-web-1  | |=+.+ **o=o       |
gitlab-web-1  | |o+oo+.oB++E      |
gitlab-web-1  | +----[SHA256]-----+
gitlab-web-1  | Preparing services...
gitlab-web-1  | Starting services...
gitlab-web-1  | Configuring GitLab...
gitlab-web-1  | /opt/gitlab/embedded/bin/runsvdir-start: line 24: ulimit: pending signals: cannot modify limit: Operation not permitted
gitlab-web-1  | /opt/gitlab/embedded/bin/runsvdir-start: line 37: /proc/sys/fs/file-max: Read-only file system
gitlab-web-1  | Starting Chef Infra Client, version 15.17.4
gitlab-web-1  | resolving cookbooks for run list: ["gitlab"]
gitlab-web-1  | Synchronizing Cookbooks:
gitlab-web-1  |   - gitlab (0.0.1)
gitlab-web-1  |   - package (0.1.0)
gitlab-web-1  |   - logrotate (0.1.0)
gitlab-web-1  |   - postgresql (0.1.0)
gitlab-web-1  |   - redis (0.1.0)
gitlab-web-1  |   - registry (0.1.0)
gitlab-web-1  |   - monitoring (0.1.0)
gitlab-web-1  |   - mattermost (0.1.0)
gitlab-web-1  |   - consul (0.1.0)
gitlab-web-1  |   - gitaly (0.1.0)
gitlab-web-1  |   - praefect (0.1.0)
gitlab-web-1  |   - gitlab-kas (0.1.0)
gitlab-web-1  |   - gitlab-pages (0.1.0)
gitlab-web-1  |   - letsencrypt (0.1.0)
gitlab-web-1  |   - nginx (0.1.0)
gitlab-web-1  |   - runit (5.1.3)
gitlab-web-1  |   - acme (4.1.3)
gitlab-web-1  |   - crond (0.1.0)
gitlab-web-1  | Installing Cookbook Gems:
gitlab-web-1  | Compiling Cookbooks...
gitlab-web-1  | Recipe: gitlab::default
gitlab-web-1  |   * directory[/etc/gitlab] action create
gitlab-web-1  |     - change mode from '0755' to '0775'
gitlab-web-1  |   Converging 313 resources
gitlab-web-1  |   * directory[/etc/gitlab] action create (up to date)
gitlab-web-1  |   * directory[Create /var/opt/gitlab] action create (up to date)
gitlab-web-1  |   * directory[Create /var/log/gitlab] action create (up to date)
gitlab-web-1  |   * directory[/opt/gitlab/embedded/etc] action create
gitlab-web-1  |     - create new directory /opt/gitlab/embedded/etc
gitlab-web-1  |     - change mode from '' to '0755'
gitlab-web-1  |     - change owner from '' to 'root'
gitlab-web-1  |     - change group from '' to 'root'
gitlab-web-1  |   * template[/opt/gitlab/embedded/etc/gitconfig] action create
gitlab-web-1  |     - create new file /opt/gitlab/embedded/etc/gitconfig
gitlab-web-1  |     - update content in file /opt/gitlab/embedded/etc/gitconfig from none to 5a725a
gitlab-web-1  |     --- /opt/gitlab/embedded/etc/gitconfig      2022-07-28 06:56:27.652728152 +0000
gitlab-web-1  |     +++ /opt/gitlab/embedded/etc/.chef-gitconfig20220728-35-3i5usn      2022-07-28 06:56:27.652728152 +0000
gitlab-web-1  |     @@ -1 +1,17 @@
gitlab-web-1  |     +[pack]
gitlab-web-1  |     +  threads = 1
gitlab-web-1  |     +[receive]
gitlab-web-1  |     +  fsckObjects = true
gitlab-web-1  |     +advertisePushOptions = true
gitlab-web-1  |     +[repack]
gitlab-web-1  |     +  writeBitmaps = true
gitlab-web-1  |     +[transfer]
gitlab-web-1  |     +  hideRefs=^refs/tmp/
gitlab-web-1  |     +hideRefs=^refs/keep-around/
gitlab-web-1  |     +hideRefs=^refs/remotes/
gitlab-web-1  |     +[core]
gitlab-web-1  |     +  alternateRefsCommand="exit 0 #"
gitlab-web-1  |     +fsyncObjectFiles = true
gitlab-web-1  |     +[fetch]
gitlab-web-1  |     +  writeCommitGraph = true
gitlab-web-1  |     - change mode from '' to '0755'
gitlab-web-1  | Recipe: gitlab::web-server
gitlab-web-1  |   * account[Webserver user and group] action create (up to date)
gitlab-web-1  | Recipe: gitlab::users
gitlab-web-1  |   * directory[/var/opt/gitlab] action create (up to date)
gitlab-web-1  |   * account[GitLab user and group] action create (up to date)
gitlab-web-1  |   * template[/var/opt/gitlab/.gitconfig] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/.gitconfig
gitlab-web-1  |     - update content in file /var/opt/gitlab/.gitconfig from none to 3f8430
gitlab-web-1  |     --- /var/opt/gitlab/.gitconfig      2022-07-28 06:56:27.688729082 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/.chef-.gitconfig20220728-35-168rjur.gitconfig   2022-07-28 06:56:27.688729082 +0000
gitlab-web-1  |     @@ -1 +1,14 @@
gitlab-web-1  |     +# This file is managed by gitlab-ctl. Manual changes will be
gitlab-web-1  |     +# erased! To change the contents below, edit /etc/gitlab/gitlab.rb
gitlab-web-1  |     +# and run `sudo gitlab-ctl reconfigure`.
gitlab-web-1  |     +
gitlab-web-1  |     +[user]
gitlab-web-1  |     +        name = GitLab
gitlab-web-1  |     +        email = gitlab@gitlab.example.com
gitlab-web-1  |     +[core]
gitlab-web-1  |     +        autocrlf = input
gitlab-web-1  |     +        alternateRefsCommand="exit 0 #"
gitlab-web-1  |     +        fsyncObjectFiles = true
gitlab-web-1  |     +[gc]
gitlab-web-1  |     +        auto = 0
gitlab-web-1  |     - change mode from '' to '0644'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |     - change group from '' to 'git'
gitlab-web-1  |   * directory[/var/opt/gitlab/.bundle] action create
gitlab-web-1  |     - create new directory /var/opt/gitlab/.bundle
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |     - change group from '' to 'git'
gitlab-web-1  | Recipe: gitlab::gitlab-shell
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/.ssh] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/.ssh] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/.ssh
gitlab-web-1  |
gitlab-web-1  |   * directory[/var/log/gitlab/gitlab-shell/] action create
gitlab-web-1  |     - create new directory /var/log/gitlab/gitlab-shell/
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |   * directory[/var/opt/gitlab/gitlab-shell] action create
gitlab-web-1  |     - create new directory /var/opt/gitlab/gitlab-shell
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |   * templatesymlink[Create a config.yml and create a symlink to Rails root] action create
gitlab-web-1  |     * template[/var/opt/gitlab/gitlab-shell/config.yml] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/gitlab-shell/config.yml
gitlab-web-1  |       - update content in file /var/opt/gitlab/gitlab-shell/config.yml from none to 237d3d
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |       - change mode from '' to '0640'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'git'
gitlab-web-1  |     * link[Link /opt/gitlab/embedded/service/gitlab-shell/config.yml to /var/opt/gitlab/gitlab-shell/config.yml] action create
gitlab-web-1  |       - create symlink at /opt/gitlab/embedded/service/gitlab-shell/config.yml to /var/opt/gitlab/gitlab-shell/config.yml
gitlab-web-1  |
gitlab-web-1  |   * link[/opt/gitlab/embedded/service/gitlab-shell/.gitlab_shell_secret] action create
gitlab-web-1  |     - create symlink at /opt/gitlab/embedded/service/gitlab-shell/.gitlab_shell_secret to /opt/gitlab/embedded/service/gitlab-rails/.gitlab_shell_secret
gitlab-web-1  |   * file[/var/opt/gitlab/.ssh/authorized_keys] action create_if_missing
gitlab-web-1  |     - create new file /var/opt/gitlab/.ssh/authorized_keys
gitlab-web-1  |     - change mode from '' to '0600'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |     - change group from '' to 'git'
gitlab-web-1  | Recipe: gitlab::gitlab-rails
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/git-data] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/git-data] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/git-data
gitlab-web-1  |
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/git-data/repositories] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/git-data/repositories] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/git-data/repositories
gitlab-web-1  |
gitlab-web-1  | Recipe: gitlab::rails_pages_shared_path
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/gitlab-rails/shared] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared
gitlab-web-1  |
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/gitlab-rails/shared/pages] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/pages] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/pages
gitlab-web-1  |
gitlab-web-1  | Recipe: gitlab::gitlab-rails
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/gitlab-rails/shared/artifacts] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/artifacts] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/artifacts
gitlab-web-1  |
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/gitlab-rails/shared/external-diffs] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/external-diffs] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/external-diffs
gitlab-web-1  |
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/gitlab-rails/shared/lfs-objects] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/lfs-objects] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/lfs-objects
gitlab-web-1  |
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/gitlab-rails/shared/packages] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/packages] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/packages
gitlab-web-1  |
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/gitlab-rails/shared/dependency_proxy] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/dependency_proxy] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/dependency_proxy
gitlab-web-1  |
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/gitlab-rails/shared/terraform_state] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/terraform_state] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/terraform_state
gitlab-web-1  |
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/gitlab-rails/shared/ci_secure_files] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/ci_secure_files] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/ci_secure_files
gitlab-web-1  |
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/gitlab-rails/shared/encrypted_settings] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/encrypted_settings] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/encrypted_settings
gitlab-web-1  |
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/gitlab-rails/uploads] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/uploads] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/uploads
gitlab-web-1  |
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/gitlab-ci/builds] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/gitlab-ci/builds] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/gitlab-ci/builds
gitlab-web-1  |
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/gitlab-rails/shared/cache] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/cache] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/cache
gitlab-web-1  |
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/gitlab-rails/shared/tmp] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/tmp] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/tmp
gitlab-web-1  |
gitlab-web-1  |   * storage_directory[/opt/gitlab/embedded/service/gitlab-rails/public] action create (skipped due to only_if)
gitlab-web-1  |   * directory[create /var/opt/gitlab/gitlab-rails/etc] action create
gitlab-web-1  |     - create new directory /var/opt/gitlab/gitlab-rails/etc
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |   * directory[create /opt/gitlab/etc/gitlab-rails] action create
gitlab-web-1  |     - create new directory /opt/gitlab/etc/gitlab-rails
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |   * directory[create /var/opt/gitlab/gitlab-rails/working] action create
gitlab-web-1  |     - create new directory /var/opt/gitlab/gitlab-rails/working
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |   * directory[create /var/opt/gitlab/gitlab-rails/tmp] action create
gitlab-web-1  |     - create new directory /var/opt/gitlab/gitlab-rails/tmp
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |   * directory[create /var/opt/gitlab/gitlab-rails/upgrade-status] action create
gitlab-web-1  |     - create new directory /var/opt/gitlab/gitlab-rails/upgrade-status
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |   * directory[create /var/log/gitlab/gitlab-rails] action create
gitlab-web-1  |     - create new directory /var/log/gitlab/gitlab-rails
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |   * storage_directory[/var/opt/gitlab/backups] action create
gitlab-web-1  |     * ruby_block[directory resource: /var/opt/gitlab/backups] action run
gitlab-web-1  |       - execute the ruby block directory resource: /var/opt/gitlab/backups
gitlab-web-1  |
gitlab-web-1  |   * directory[/var/opt/gitlab/gitlab-rails] action create
gitlab-web-1  |     - change owner from 'root' to 'git'
gitlab-web-1  |   * directory[/var/opt/gitlab/gitlab-ci] action create
gitlab-web-1  |     - change owner from 'root' to 'git'
gitlab-web-1  |   * file[/var/opt/gitlab/gitlab-rails/etc/gitlab-registry.key] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/gitlab-rails/etc/gitlab-registry.key
gitlab-web-1  |     - update content in file /var/opt/gitlab/gitlab-rails/etc/gitlab-registry.key from none to 754ad9
gitlab-web-1  |     - suppressed sensitive resource
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |     - change group from '' to 'git'
gitlab-web-1  |   * template[/opt/gitlab/etc/gitlab-rails-rc] action create
gitlab-web-1  |     - create new file /opt/gitlab/etc/gitlab-rails-rc
gitlab-web-1  |     - update content in file /opt/gitlab/etc/gitlab-rails-rc from none to 000a09
gitlab-web-1  |     --- /opt/gitlab/etc/gitlab-rails-rc 2022-07-28 06:56:32.772860433 +0000
gitlab-web-1  |     +++ /opt/gitlab/etc/.chef-gitlab-rails-rc20220728-35-uk54ib 2022-07-28 06:56:32.772860433 +0000
gitlab-web-1  |     @@ -1 +1,6 @@
gitlab-web-1  |     +gitlab_user='git'
gitlab-web-1  |     +gitlab_group='git'
gitlab-web-1  |     +registry_dir='/var/opt/gitlab/gitlab-rails/shared/registry'
gitlab-web-1  |     +registry_user='registry'
gitlab-web-1  |     +registry_group='registry'
gitlab-web-1  |     - change mode from '' to '0644'
gitlab-web-1  |     - change owner from '' to 'root'
gitlab-web-1  |     - change group from '' to 'root'
gitlab-web-1  |   * file[/opt/gitlab/etc/gitlab-rails/gitlab-rails-rc] action delete (up to date)
gitlab-web-1  |   * file[/opt/gitlab/embedded/service/gitlab-rails/.secret] action delete (up to date)
gitlab-web-1  |   * file[/var/opt/gitlab/gitlab-rails/etc/secret] action delete (up to date)
gitlab-web-1  |   * templatesymlink[Create a database.yml and create a symlink to Rails root] action create
gitlab-web-1  |     * template[/var/opt/gitlab/gitlab-rails/etc/database.yml] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/gitlab-rails/etc/database.yml
gitlab-web-1  |       - update content in file /var/opt/gitlab/gitlab-rails/etc/database.yml from none to 5f618f
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |       - change mode from '' to '0640'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'git'
gitlab-web-1  |     * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/database.yml to /var/opt/gitlab/gitlab-rails/etc/database.yml] action create
gitlab-web-1  |       - create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/database.yml to /var/opt/gitlab/gitlab-rails/etc/database.yml
gitlab-web-1  |
gitlab-web-1  |   * templatesymlink[Create a secrets.yml and create a symlink to Rails root] action create
gitlab-web-1  |     * template[/var/opt/gitlab/gitlab-rails/etc/secrets.yml] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/gitlab-rails/etc/secrets.yml
gitlab-web-1  |       - update content in file /var/opt/gitlab/gitlab-rails/etc/secrets.yml from none to 5fad08
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |       - change mode from '' to '0644'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/secrets.yml to /var/opt/gitlab/gitlab-rails/etc/secrets.yml] action create
gitlab-web-1  |       - create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/secrets.yml to /var/opt/gitlab/gitlab-rails/etc/secrets.yml
gitlab-web-1  |
gitlab-web-1  |   * templatesymlink[Create a resque.yml and create a symlink to Rails root] action create
gitlab-web-1  |     * template[/var/opt/gitlab/gitlab-rails/etc/resque.yml] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/gitlab-rails/etc/resque.yml
gitlab-web-1  |       - update content in file /var/opt/gitlab/gitlab-rails/etc/resque.yml from none to ec4232
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |       - change mode from '' to '0644'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/resque.yml to /var/opt/gitlab/gitlab-rails/etc/resque.yml] action create
gitlab-web-1  |       - create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/resque.yml to /var/opt/gitlab/gitlab-rails/etc/resque.yml
gitlab-web-1  |
gitlab-web-1  |   * templatesymlink[Create a cable.yml and create a symlink to Rails root] action create
gitlab-web-1  |     * template[/var/opt/gitlab/gitlab-rails/etc/cable.yml] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/gitlab-rails/etc/cable.yml
gitlab-web-1  |       - update content in file /var/opt/gitlab/gitlab-rails/etc/cable.yml from none to 551667
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |       - change mode from '' to '0644'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/cable.yml to /var/opt/gitlab/gitlab-rails/etc/cable.yml] action create
gitlab-web-1  |       - create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/cable.yml to /var/opt/gitlab/gitlab-rails/etc/cable.yml
gitlab-web-1  |
gitlab-web-1  |   * templatesymlink[Create a redis.cache.yml and create a symlink to Rails root] action create (skipped due to not_if)
gitlab-web-1  |   * file[/opt/gitlab/embedded/service/gitlab-rails/config/redis.cache.yml] action delete (up to date)
gitlab-web-1  |   * file[/var/opt/gitlab/gitlab-rails/etc/redis.cache.yml] action delete (up to date)
gitlab-web-1  |   * templatesymlink[Create a redis.queues.yml and create a symlink to Rails root] action create (skipped due to not_if)
gitlab-web-1  |   * file[/opt/gitlab/embedded/service/gitlab-rails/config/redis.queues.yml] action delete (up to date)
gitlab-web-1  |   * file[/var/opt/gitlab/gitlab-rails/etc/redis.queues.yml] action delete (up to date)
gitlab-web-1  |   * templatesymlink[Create a redis.shared_state.yml and create a symlink to Rails root] action create (skipped due to not_if)
gitlab-web-1  |   * file[/opt/gitlab/embedded/service/gitlab-rails/config/redis.shared_state.yml] action delete (up to date)
gitlab-web-1  |   * file[/var/opt/gitlab/gitlab-rails/etc/redis.shared_state.yml] action delete (up to date)
gitlab-web-1  |   * templatesymlink[Create a redis.trace_chunks.yml and create a symlink to Rails root] action create (skipped due to not_if)
gitlab-web-1  |   * file[/opt/gitlab/embedded/service/gitlab-rails/config/redis.trace_chunks.yml] action delete (up to date)
gitlab-web-1  |   * file[/var/opt/gitlab/gitlab-rails/etc/redis.trace_chunks.yml] action delete (up to date)
gitlab-web-1  |   * templatesymlink[Create a redis.rate_limiting.yml and create a symlink to Rails root] action create (skipped due to not_if)
gitlab-web-1  |   * file[/opt/gitlab/embedded/service/gitlab-rails/config/redis.rate_limiting.yml] action delete (up to date)
gitlab-web-1  |   * file[/var/opt/gitlab/gitlab-rails/etc/redis.rate_limiting.yml] action delete (up to date)
gitlab-web-1  |   * templatesymlink[Create a redis.sessions.yml and create a symlink to Rails root] action create (skipped due to not_if)
gitlab-web-1  |   * file[/opt/gitlab/embedded/service/gitlab-rails/config/redis.sessions.yml] action delete (up to date)
gitlab-web-1  |   * file[/var/opt/gitlab/gitlab-rails/etc/redis.sessions.yml] action delete (up to date)
gitlab-web-1  |   * templatesymlink[Create a smtp_settings.rb and create a symlink to Rails root] action delete
gitlab-web-1  |     * file[/var/opt/gitlab/gitlab-rails/etc/smtp_settings.rb] action delete (up to date)
gitlab-web-1  |     * link[/opt/gitlab/embedded/service/gitlab-rails/config/initializers/smtp_settings.rb] action delete (up to date)
gitlab-web-1  |      (up to date)
gitlab-web-1  |   * templatesymlink[Create a gitlab.yml and create a symlink to Rails root] action create
gitlab-web-1  |     * template[/var/opt/gitlab/gitlab-rails/etc/gitlab.yml] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/gitlab-rails/etc/gitlab.yml
gitlab-web-1  |       - update content in file /var/opt/gitlab/gitlab-rails/etc/gitlab.yml from none to 47c43e
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |       - change mode from '' to '0640'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'git'
gitlab-web-1  |     * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/gitlab.yml to /var/opt/gitlab/gitlab-rails/etc/gitlab.yml] action create
gitlab-web-1  |       - create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/gitlab.yml to /var/opt/gitlab/gitlab-rails/etc/gitlab.yml
gitlab-web-1  |
gitlab-web-1  |   * templatesymlink[Create a gitlab_workhorse_secret and create a symlink to Rails root] action create
gitlab-web-1  |     * template[/var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret
gitlab-web-1  |       - update content in file /var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret from none to 7ff38a
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |       - change mode from '' to '0644'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * link[Link /opt/gitlab/embedded/service/gitlab-rails/.gitlab_workhorse_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret] action create
gitlab-web-1  |       - create symlink at /opt/gitlab/embedded/service/gitlab-rails/.gitlab_workhorse_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret
gitlab-web-1  |
gitlab-web-1  |   * templatesymlink[Create a gitlab_shell_secret and create a symlink to Rails root] action create
gitlab-web-1  |     * template[/var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret
gitlab-web-1  |       - update content in file /var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret from none to 06791f
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |       - change mode from '' to '0644'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * link[Link /opt/gitlab/embedded/service/gitlab-rails/.gitlab_shell_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret] action create
gitlab-web-1  |       - create symlink at /opt/gitlab/embedded/service/gitlab-rails/.gitlab_shell_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret
gitlab-web-1  |
gitlab-web-1  |   * templatesymlink[Create a gitlab_incoming_email_secret and create a symlink to Rails root] action create (skipped due to only_if)
gitlab-web-1  |   * templatesymlink[Create a gitlab_service_desk_email_secret and create a symlink to Rails root] action create (skipped due to only_if)
gitlab-web-1  |   * templatesymlink[Create a gitlab_pages_secret and create a symlink to Rails root] action create
gitlab-web-1  |     * template[/var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret
gitlab-web-1  |       - update content in file /var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret from none to c4063f
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |       - change mode from '' to '0644'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * link[Link /opt/gitlab/embedded/service/gitlab-rails/.gitlab_pages_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret] action create
gitlab-web-1  |       - create symlink at /opt/gitlab/embedded/service/gitlab-rails/.gitlab_pages_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret
gitlab-web-1  |
gitlab-web-1  |   * templatesymlink[Create a gitlab_kas_secret and create a symlink to Rails root] action create
gitlab-web-1  |     * template[/var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret
gitlab-web-1  |       - update content in file /var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret from none to 1963f7
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |       - change mode from '' to '0644'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * link[Link /opt/gitlab/embedded/service/gitlab-rails/.gitlab_kas_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret] action create
gitlab-web-1  |       - create symlink at /opt/gitlab/embedded/service/gitlab-rails/.gitlab_kas_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret
gitlab-web-1  |
gitlab-web-1  |   * link[/opt/gitlab/embedded/service/gitlab-rails/config/initializers/relative_url.rb] action delete (up to date)
gitlab-web-1  |   * file[/var/opt/gitlab/gitlab-rails/etc/relative_url.rb] action delete (up to date)
gitlab-web-1  |   * env_dir[/opt/gitlab/etc/gitlab-rails/env] action create
gitlab-web-1  |     * directory[/opt/gitlab/etc/gitlab-rails/env] action create
gitlab-web-1  |       - create new directory /opt/gitlab/etc/gitlab-rails/env
gitlab-web-1  |     * file[/opt/gitlab/etc/gitlab-rails/env/HOME] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitlab-rails/env/HOME
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitlab-rails/env/HOME from none to 205bb9
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitlab-rails/env/RAILS_ENV] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitlab-rails/env/RAILS_ENV
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitlab-rails/env/RAILS_ENV from none to ab8e18
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitlab-rails/env/LD_PRELOAD] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitlab-rails/env/LD_PRELOAD
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitlab-rails/env/LD_PRELOAD from none to f79114
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitlab-rails/env/BUNDLE_GEMFILE] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitlab-rails/env/BUNDLE_GEMFILE
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitlab-rails/env/BUNDLE_GEMFILE from none to 28d586
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitlab-rails/env/SIDEKIQ_MEMORY_KILLER_MAX_RSS] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitlab-rails/env/SIDEKIQ_MEMORY_KILLER_MAX_RSS
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitlab-rails/env/SIDEKIQ_MEMORY_KILLER_MAX_RSS from none to dd80d7
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitlab-rails/env/PATH] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitlab-rails/env/PATH
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitlab-rails/env/PATH from none to d5dc07
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitlab-rails/env/ICU_DATA] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitlab-rails/env/ICU_DATA
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitlab-rails/env/ICU_DATA from none to a04260
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitlab-rails/env/PYTHONPATH] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitlab-rails/env/PYTHONPATH
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitlab-rails/env/PYTHONPATH from none to 98c9f4
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitlab-rails/env/EXECJS_RUNTIME] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitlab-rails/env/EXECJS_RUNTIME
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitlab-rails/env/EXECJS_RUNTIME from none to 75081b
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitlab-rails/env/TZ] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitlab-rails/env/TZ
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitlab-rails/env/TZ from none to 983a95
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitlab-rails/env/SSL_CERT_DIR] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitlab-rails/env/SSL_CERT_DIR
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitlab-rails/env/SSL_CERT_DIR from none to 4f45cf
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitlab-rails/env/SSL_CERT_FILE] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitlab-rails/env/SSL_CERT_FILE
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitlab-rails/env/SSL_CERT_FILE from none to f7ce84
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |
gitlab-web-1  |   * link[/opt/gitlab/embedded/service/gitlab-rails/tmp] action create
gitlab-web-1  |     - create symlink at /opt/gitlab/embedded/service/gitlab-rails/tmp to /var/opt/gitlab/gitlab-rails/tmp
gitlab-web-1  |   * link[/opt/gitlab/embedded/service/gitlab-rails/public/uploads] action create
gitlab-web-1  |     - create symlink at /opt/gitlab/embedded/service/gitlab-rails/public/uploads to /var/opt/gitlab/gitlab-rails/uploads
gitlab-web-1  |   * link[/opt/gitlab/embedded/service/gitlab-rails/log] action create
gitlab-web-1  |     - create symlink at /opt/gitlab/embedded/service/gitlab-rails/log to /var/log/gitlab/gitlab-rails
gitlab-web-1  |   * link[/var/log/gitlab/gitlab-rails/sidekiq.log] action delete (skipped due to only_if)
gitlab-web-1  |   * file[/opt/gitlab/embedded/service/gitlab-rails/db/structure.sql] action create
gitlab-web-1  |     - change owner from 'root' to 'git'
gitlab-web-1  | /opt/gitlab/embedded/lib/ruby/gems/2.7.0/gems/chef-15.17.4/lib/chef/provider/remote_file/local_file.rb:43: warning: URI.unescape is obsolete
gitlab-web-1  |   * remote_file[/var/opt/gitlab/gitlab-rails/VERSION] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/gitlab-rails/VERSION
gitlab-web-1  |     - update content in file /var/opt/gitlab/gitlab-rails/VERSION from none to d21fc8
gitlab-web-1  |     --- /var/opt/gitlab/gitlab-rails/VERSION    2022-07-28 06:56:33.832887819 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/gitlab-rails/.chef-VERSION20220728-35-6qf5n     2022-07-28 06:56:33.832887819 +0000
gitlab-web-1  |     @@ -1 +1,2 @@
gitlab-web-1  |     +14.10.5
gitlab-web-1  | /opt/gitlab/embedded/lib/ruby/gems/2.7.0/gems/chef-15.17.4/lib/chef/provider/remote_file/local_file.rb:43: warning: URI.unescape is obsolete
gitlab-web-1  |   * remote_file[/var/opt/gitlab/gitlab-rails/REVISION] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/gitlab-rails/REVISION
gitlab-web-1  |     - update content in file /var/opt/gitlab/gitlab-rails/REVISION from none to b4c653
gitlab-web-1  |     --- /var/opt/gitlab/gitlab-rails/REVISION   2022-07-28 06:56:33.864888646 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/gitlab-rails/.chef-REVISION20220728-35-1l2meey  2022-07-28 06:56:33.864888646 +0000
gitlab-web-1  |     @@ -1 +1,2 @@
gitlab-web-1  |     +02cdf459a13
gitlab-web-1  |   * version_file[Create version file for Rails] action create
gitlab-web-1  |     * file[/var/opt/gitlab/gitlab-rails/RUBY_VERSION] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/gitlab-rails/RUBY_VERSION
gitlab-web-1  |       - update content in file /var/opt/gitlab/gitlab-rails/RUBY_VERSION from none to 47ac47
gitlab-web-1  |       --- /var/opt/gitlab/gitlab-rails/RUBY_VERSION     2022-07-28 06:56:33.944890713 +0000
gitlab-web-1  |       +++ /var/opt/gitlab/gitlab-rails/.chef-RUBY_VERSION20220728-35-1cihosn    2022-07-28 06:56:33.944890713 +0000
gitlab-web-1  |       @@ -1 +1,2 @@
gitlab-web-1  |       +ruby 2.7.5p203 (2021-11-24 revision f69aeb8314) [x86_64-linux]
gitlab-web-1  |
gitlab-web-1  |   * execute[clear the gitlab-rails cache] action nothing (skipped due to action :nothing)
gitlab-web-1  |   * file[/var/opt/gitlab/gitlab-rails/config.ru] action delete (up to date)
gitlab-web-1  | Recipe: gitlab::selinux
gitlab-web-1  |   * bash[Set proper security context on ssh files for selinux] action nothing (skipped due to action :nothing)
gitlab-web-1  | Recipe: gitlab::add_trusted_certs
gitlab-web-1  |   * directory[/etc/gitlab/trusted-certs] action create
gitlab-web-1  |     - create new directory /etc/gitlab/trusted-certs
gitlab-web-1  |     - change mode from '' to '0755'
gitlab-web-1  |   * directory[/opt/gitlab/embedded/ssl/certs] action create (up to date)
gitlab-web-1  |   * file[/opt/gitlab/embedded/ssl/certs/README] action create
gitlab-web-1  |     - create new file /opt/gitlab/embedded/ssl/certs/README
gitlab-web-1  |     - update content in file /opt/gitlab/embedded/ssl/certs/README from none to 623059
gitlab-web-1  |     --- /opt/gitlab/embedded/ssl/certs/README   2022-07-28 06:56:33.996892057 +0000
gitlab-web-1  |     +++ /opt/gitlab/embedded/ssl/certs/.chef-README20220728-35-7ms8l8   2022-07-28 06:56:33.996892057 +0000
gitlab-web-1  |     @@ -1 +1,4 @@
gitlab-web-1  |     +This directory is managed by omnibus-gitlab.
gitlab-web-1  |     + Any file placed in this directory will be ignored
gitlab-web-1  |     +. Place certificates in /etc/gitlab/trusted-certs.
gitlab-web-1  |     - change mode from '' to '0644'
gitlab-web-1  |   * ruby_block[Move existing certs and link to /opt/gitlab/embedded/ssl/certs] action run
gitlab-web-1  |
gitlab-web-1  |   * Moving existing certificates found in /opt/gitlab/embedded/ssl/certs
gitlab-web-1  |
gitlab-web-1  |   * Symlinking existing certificates found in /etc/gitlab/trusted-certs
gitlab-web-1  |
gitlab-web-1  |     - execute the ruby block Move existing certs and link to /opt/gitlab/embedded/ssl/certs
gitlab-web-1  | Recipe: gitlab::default
gitlab-web-1  |   * service[create a temporary puma service] action nothing (skipped due to action :nothing)
gitlab-web-1  |   * service[create a temporary sidekiq service] action nothing (skipped due to action :nothing)
gitlab-web-1  |   * service[create a temporary mailroom service] action nothing (skipped due to action :nothing)
gitlab-web-1  | Recipe: package::sysctl
gitlab-web-1  |   * execute[reload all sysctl conf] action nothing (skipped due to action :nothing)
gitlab-web-1  | Recipe: logrotate::folders_and_configs
gitlab-web-1  |   * directory[/var/opt/gitlab/logrotate] action create
gitlab-web-1  |     - create new directory /var/opt/gitlab/logrotate
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |   * directory[/var/opt/gitlab/logrotate/logrotate.d] action create
gitlab-web-1  |     - create new directory /var/opt/gitlab/logrotate/logrotate.d
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |   * directory[/var/log/gitlab/logrotate] action create
gitlab-web-1  |     - create new directory /var/log/gitlab/logrotate
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |   * template[/var/opt/gitlab/logrotate/logrotate.conf] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/logrotate/logrotate.conf
gitlab-web-1  |     - update content in file /var/opt/gitlab/logrotate/logrotate.conf from none to c1c320
gitlab-web-1  |     --- /var/opt/gitlab/logrotate/logrotate.conf        2022-07-28 06:56:34.124895364 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/logrotate/.chef-logrotate20220728-35-ib1ym8.conf        2022-07-28 06:56:34.124895364 +0000
gitlab-web-1  |     @@ -1 +1,13 @@
gitlab-web-1  |     +# Generated by 'gitlab-ctl reconfigure'.
gitlab-web-1  |     +# Modifications will be overwritten!
gitlab-web-1  |     +
gitlab-web-1  |     +include /var/opt/gitlab/logrotate/logrotate.d/nginx
gitlab-web-1  |     +include /var/opt/gitlab/logrotate/logrotate.d/puma
gitlab-web-1  |     +include /var/opt/gitlab/logrotate/logrotate.d/gitlab-rails
gitlab-web-1  |     +include /var/opt/gitlab/logrotate/logrotate.d/gitlab-shell
gitlab-web-1  |     +include /var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse
gitlab-web-1  |     +include /var/opt/gitlab/logrotate/logrotate.d/gitlab-pages
gitlab-web-1  |     +include /var/opt/gitlab/logrotate/logrotate.d/gitlab-kas
gitlab-web-1  |     +include /var/opt/gitlab/logrotate/logrotate.d/gitaly
gitlab-web-1  |     +include /var/opt/gitlab/logrotate/logrotate.d/mailroom
gitlab-web-1  |     - change mode from '' to '0644'
gitlab-web-1  |   * template[/var/opt/gitlab/logrotate/logrotate.d/nginx] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/logrotate/logrotate.d/nginx
gitlab-web-1  |     - update content in file /var/opt/gitlab/logrotate/logrotate.d/nginx from none to e17e19
gitlab-web-1  |     --- /var/opt/gitlab/logrotate/logrotate.d/nginx     2022-07-28 06:56:34.160896293 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/logrotate/logrotate.d/.chef-nginx20220728-35-1hks56y    2022-07-28 06:56:34.160896293 +0000
gitlab-web-1  |     @@ -1 +1,18 @@
gitlab-web-1  |     +# Generated by gitlab-ctl reconfigure
gitlab-web-1  |     +# Modifications will be overwritten!
gitlab-web-1  |     +
gitlab-web-1  |     +/var/log/gitlab/nginx/*.log {
gitlab-web-1  |     +  su root root
gitlab-web-1  |     +  daily
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +  rotate 30
gitlab-web-1  |     +  compress
gitlab-web-1  |     +  copytruncate
gitlab-web-1  |     +  missingok
gitlab-web-1  |     +  notifempty
gitlab-web-1  |     +  postrotate
gitlab-web-1  |     +
gitlab-web-1  |     +  endscript
gitlab-web-1  |     +}
gitlab-web-1  |   * template[/var/opt/gitlab/logrotate/logrotate.d/puma] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/logrotate/logrotate.d/puma
gitlab-web-1  |     - update content in file /var/opt/gitlab/logrotate/logrotate.d/puma from none to 44ad27
gitlab-web-1  |     --- /var/opt/gitlab/logrotate/logrotate.d/puma      2022-07-28 06:56:34.192897120 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/logrotate/logrotate.d/.chef-puma20220728-35-1f6u2nh     2022-07-28 06:56:34.192897120 +0000
gitlab-web-1  |     @@ -1 +1,18 @@
gitlab-web-1  |     +# Generated by gitlab-ctl reconfigure
gitlab-web-1  |     +# Modifications will be overwritten!
gitlab-web-1  |     +
gitlab-web-1  |     +/var/log/gitlab/puma/*.log {
gitlab-web-1  |     +  su git git
gitlab-web-1  |     +  daily
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +  rotate 30
gitlab-web-1  |     +  compress
gitlab-web-1  |     +  copytruncate
gitlab-web-1  |     +  missingok
gitlab-web-1  |     +  notifempty
gitlab-web-1  |     +  postrotate
gitlab-web-1  |     +
gitlab-web-1  |     +  endscript
gitlab-web-1  |     +}
gitlab-web-1  |   * template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-rails] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/logrotate/logrotate.d/gitlab-rails
gitlab-web-1  |     - update content in file /var/opt/gitlab/logrotate/logrotate.d/gitlab-rails from none to 26254a
gitlab-web-1  |     --- /var/opt/gitlab/logrotate/logrotate.d/gitlab-rails      2022-07-28 06:56:34.224897947 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitlab-rails20220728-35-405er3      2022-07-28 06:56:34.224897947 +0000
gitlab-web-1  |     @@ -1 +1,18 @@
gitlab-web-1  |     +# Generated by gitlab-ctl reconfigure
gitlab-web-1  |     +# Modifications will be overwritten!
gitlab-web-1  |     +
gitlab-web-1  |     +/var/log/gitlab/gitlab-rails/*.log {
gitlab-web-1  |     +  su git git
gitlab-web-1  |     +  daily
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +  rotate 30
gitlab-web-1  |     +  compress
gitlab-web-1  |     +  copytruncate
gitlab-web-1  |     +  missingok
gitlab-web-1  |     +  notifempty
gitlab-web-1  |     +  postrotate
gitlab-web-1  |     +
gitlab-web-1  |     +  endscript
gitlab-web-1  |     +}
gitlab-web-1  |   * template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-shell] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/logrotate/logrotate.d/gitlab-shell
gitlab-web-1  |     - update content in file /var/opt/gitlab/logrotate/logrotate.d/gitlab-shell from none to 3a880d
gitlab-web-1  |     --- /var/opt/gitlab/logrotate/logrotate.d/gitlab-shell      2022-07-28 06:56:34.256898774 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitlab-shell20220728-35-w8pp0m      2022-07-28 06:56:34.256898774 +0000
gitlab-web-1  |     @@ -1 +1,18 @@
gitlab-web-1  |     +# Generated by gitlab-ctl reconfigure
gitlab-web-1  |     +# Modifications will be overwritten!
gitlab-web-1  |     +
gitlab-web-1  |     +/var/log/gitlab/gitlab-shell//*.log {
gitlab-web-1  |     +  su git git
gitlab-web-1  |     +  daily
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +  rotate 30
gitlab-web-1  |     +  compress
gitlab-web-1  |     +  copytruncate
gitlab-web-1  |     +  missingok
gitlab-web-1  |     +  notifempty
gitlab-web-1  |     +  postrotate
gitlab-web-1  |     +
gitlab-web-1  |     +  endscript
gitlab-web-1  |     +}
gitlab-web-1  |   * template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse
gitlab-web-1  |     - update content in file /var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse from none to 3453f6
gitlab-web-1  |     --- /var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse  2022-07-28 06:56:34.276899291 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitlab-workhorse20220728-35-1n1esxn 2022-07-28 06:56:34.276899291 +0000
gitlab-web-1  |     @@ -1 +1,18 @@
gitlab-web-1  |     +# Generated by gitlab-ctl reconfigure
gitlab-web-1  |     +# Modifications will be overwritten!
gitlab-web-1  |     +
gitlab-web-1  |     +/var/log/gitlab/gitlab-workhorse/*.log {
gitlab-web-1  |     +  su git git
gitlab-web-1  |     +  daily
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +  rotate 30
gitlab-web-1  |     +  compress
gitlab-web-1  |     +  copytruncate
gitlab-web-1  |     +  missingok
gitlab-web-1  |     +  notifempty
gitlab-web-1  |     +  postrotate
gitlab-web-1  |     +
gitlab-web-1  |     +  endscript
gitlab-web-1  |     +}
gitlab-web-1  |   * template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-pages] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/logrotate/logrotate.d/gitlab-pages
gitlab-web-1  |     - update content in file /var/opt/gitlab/logrotate/logrotate.d/gitlab-pages from none to 3c118a
gitlab-web-1  |     --- /var/opt/gitlab/logrotate/logrotate.d/gitlab-pages      2022-07-28 06:56:34.308900117 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitlab-pages20220728-35-m49e04      2022-07-28 06:56:34.308900117 +0000
gitlab-web-1  |     @@ -1 +1,18 @@
gitlab-web-1  |     +# Generated by gitlab-ctl reconfigure
gitlab-web-1  |     +# Modifications will be overwritten!
gitlab-web-1  |     +
gitlab-web-1  |     +/var/log/gitlab/gitlab-pages/*.log {
gitlab-web-1  |     +  su git git
gitlab-web-1  |     +  daily
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +  rotate 30
gitlab-web-1  |     +  compress
gitlab-web-1  |     +  copytruncate
gitlab-web-1  |     +  missingok
gitlab-web-1  |     +  notifempty
gitlab-web-1  |     +  postrotate
gitlab-web-1  |     +
gitlab-web-1  |     +  endscript
gitlab-web-1  |     +}
gitlab-web-1  |   * template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-kas] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/logrotate/logrotate.d/gitlab-kas
gitlab-web-1  |     - update content in file /var/opt/gitlab/logrotate/logrotate.d/gitlab-kas from none to 0ba4f0
gitlab-web-1  |     --- /var/opt/gitlab/logrotate/logrotate.d/gitlab-kas        2022-07-28 06:56:34.328900634 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitlab-kas20220728-35-1885tjb       2022-07-28 06:56:34.328900634 +0000
gitlab-web-1  |     @@ -1 +1,18 @@
gitlab-web-1  |     +# Generated by gitlab-ctl reconfigure
gitlab-web-1  |     +# Modifications will be overwritten!
gitlab-web-1  |     +
gitlab-web-1  |     +/var/log/gitlab/gitlab-kas/*.log {
gitlab-web-1  |     +  su git git
gitlab-web-1  |     +  daily
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +  rotate 30
gitlab-web-1  |     +  compress
gitlab-web-1  |     +  copytruncate
gitlab-web-1  |     +  missingok
gitlab-web-1  |     +  notifempty
gitlab-web-1  |     +  postrotate
gitlab-web-1  |     +
gitlab-web-1  |     +  endscript
gitlab-web-1  |     +}
gitlab-web-1  |   * template[/var/opt/gitlab/logrotate/logrotate.d/gitaly] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/logrotate/logrotate.d/gitaly
gitlab-web-1  |     - update content in file /var/opt/gitlab/logrotate/logrotate.d/gitaly from none to 02bda7
gitlab-web-1  |     --- /var/opt/gitlab/logrotate/logrotate.d/gitaly    2022-07-28 06:56:34.356901357 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitaly20220728-35-4gxbxb    2022-07-28 06:56:34.356901357 +0000
gitlab-web-1  |     @@ -1 +1,18 @@
gitlab-web-1  |     +# Generated by gitlab-ctl reconfigure
gitlab-web-1  |     +# Modifications will be overwritten!
gitlab-web-1  |     +
gitlab-web-1  |     +/var/log/gitlab/gitaly/*.log {
gitlab-web-1  |     +  su git git
gitlab-web-1  |     +  daily
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +  rotate 30
gitlab-web-1  |     +  compress
gitlab-web-1  |     +  copytruncate
gitlab-web-1  |     +  missingok
gitlab-web-1  |     +  notifempty
gitlab-web-1  |     +  postrotate
gitlab-web-1  |     +
gitlab-web-1  |     +  endscript
gitlab-web-1  |     +}
gitlab-web-1  |   * template[/var/opt/gitlab/logrotate/logrotate.d/mailroom] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/logrotate/logrotate.d/mailroom
gitlab-web-1  |     - update content in file /var/opt/gitlab/logrotate/logrotate.d/mailroom from none to 8fcea3
gitlab-web-1  |     --- /var/opt/gitlab/logrotate/logrotate.d/mailroom  2022-07-28 06:56:34.384902081 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/logrotate/logrotate.d/.chef-mailroom20220728-35-s0hyeu  2022-07-28 06:56:34.384902081 +0000
gitlab-web-1  |     @@ -1 +1,18 @@
gitlab-web-1  |     +# Generated by gitlab-ctl reconfigure
gitlab-web-1  |     +# Modifications will be overwritten!
gitlab-web-1  |     +
gitlab-web-1  |     +/var/log/gitlab/mailroom/*.log {
gitlab-web-1  |     +  su git git
gitlab-web-1  |     +  daily
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +  rotate 30
gitlab-web-1  |     +  compress
gitlab-web-1  |     +  copytruncate
gitlab-web-1  |     +  missingok
gitlab-web-1  |     +  notifempty
gitlab-web-1  |     +  postrotate
gitlab-web-1  |     +
gitlab-web-1  |     +  endscript
gitlab-web-1  |     +}
gitlab-web-1  | Recipe: logrotate::enable
gitlab-web-1  |   * service[logrotate] action nothing (skipped due to action :nothing)
gitlab-web-1  |   * runit_service[logrotate] action enable
gitlab-web-1  |     * ruby_block[restart_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * directory[/opt/gitlab/sv/logrotate] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/logrotate
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * template[/opt/gitlab/sv/logrotate/run] action create
gitlab-web-1  |       - create new file /opt/gitlab/sv/logrotate/run
gitlab-web-1  |       - update content in file /opt/gitlab/sv/logrotate/run from none to 07f1b6
gitlab-web-1  |       --- /opt/gitlab/sv/logrotate/run  2022-07-28 06:56:34.436903424 +0000
gitlab-web-1  |       +++ /opt/gitlab/sv/logrotate/.chef-run20220728-35-1fbloo0 2022-07-28 06:56:34.436903424 +0000
gitlab-web-1  |       @@ -1 +1,11 @@
gitlab-web-1  |       +#!/bin/sh
gitlab-web-1  |       +exec 2>&1
gitlab-web-1  |       +
gitlab-web-1  |       +cd /var/opt/gitlab/logrotate
gitlab-web-1  |       +
gitlab-web-1  |       +exec /opt/gitlab/embedded/bin/chpst -P /usr/bin/env \
gitlab-web-1  |       +  dir=/var/opt/gitlab/logrotate \
gitlab-web-1  |       +  pre_sleep=600 \
gitlab-web-1  |       +  post_sleep=3000 \
gitlab-web-1  |       +  /opt/gitlab/embedded/bin/gitlab-logrotate-wrapper
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * directory[/opt/gitlab/sv/logrotate/log] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/logrotate/log
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * directory[/opt/gitlab/sv/logrotate/log/main] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/logrotate/log/main
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * template[/opt/gitlab/sv/logrotate/log/config] action create
gitlab-web-1  |       - create new file /opt/gitlab/sv/logrotate/log/config
gitlab-web-1  |       - update content in file /opt/gitlab/sv/logrotate/log/config from none to 623c00
gitlab-web-1  |       --- /opt/gitlab/sv/logrotate/log/config   2022-07-28 06:56:34.484904665 +0000
gitlab-web-1  |       +++ /opt/gitlab/sv/logrotate/log/.chef-config20220728-35-1tsiy60  2022-07-28 06:56:34.484904665 +0000
gitlab-web-1  |       @@ -1 +1,7 @@
gitlab-web-1  |       +s209715200
gitlab-web-1  |       +n30
gitlab-web-1  |       +t86400
gitlab-web-1  |       +!gzip
gitlab-web-1  |       +
gitlab-web-1  |       +
gitlab-web-1  |       - change mode from '' to '0644'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * ruby_block[verify_chown_persisted_on_logrotate] action create
gitlab-web-1  |       - execute the ruby block verify_chown_persisted_on_logrotate
gitlab-web-1  |     * ruby_block[verify_chown_persisted_on_logrotate] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * link[/var/log/gitlab/logrotate/config] action create
gitlab-web-1  |       - create symlink at /var/log/gitlab/logrotate/config to /opt/gitlab/sv/logrotate/log/config
gitlab-web-1  |     * template[/opt/gitlab/sv/logrotate/log/run] action create
gitlab-web-1  |       - create new file /opt/gitlab/sv/logrotate/log/run
gitlab-web-1  |       - update content in file /opt/gitlab/sv/logrotate/log/run from none to 94afe6
gitlab-web-1  |       --- /opt/gitlab/sv/logrotate/log/run      2022-07-28 06:56:34.520905595 +0000
gitlab-web-1  |       +++ /opt/gitlab/sv/logrotate/log/.chef-run20220728-35-1dbri5q     2022-07-28 06:56:34.520905595 +0000
gitlab-web-1  |       @@ -1 +1,3 @@
gitlab-web-1  |       +#!/bin/sh
gitlab-web-1  |       +exec svlogd -tt /var/log/gitlab/logrotate
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * directory[/opt/gitlab/sv/logrotate/env] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/logrotate/env
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * ruby_block[Delete unmanaged env files for logrotate service] action run (skipped due to only_if)
gitlab-web-1  |     * template[/opt/gitlab/sv/logrotate/check] action create (skipped due to only_if)
gitlab-web-1  |     * template[/opt/gitlab/sv/logrotate/finish] action create (skipped due to only_if)
gitlab-web-1  |     * directory[/opt/gitlab/sv/logrotate/control] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/logrotate/control
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * template[/opt/gitlab/sv/logrotate/control/t] action create
gitlab-web-1  |       - create new file /opt/gitlab/sv/logrotate/control/t
gitlab-web-1  |       - update content in file /opt/gitlab/sv/logrotate/control/t from none to 8fa3fa
gitlab-web-1  |       --- /opt/gitlab/sv/logrotate/control/t    2022-07-28 06:56:34.568906835 +0000
gitlab-web-1  |       +++ /opt/gitlab/sv/logrotate/control/.chef-t20220728-35-1r2a0bm   2022-07-28 06:56:34.568906835 +0000
gitlab-web-1  |       @@ -1 +1,4 @@
gitlab-web-1  |       +#!/bin/sh
gitlab-web-1  |       +echo "Received TERM from runit, sending to process group (-PID)"
gitlab-web-1  |       +kill -- -$(cat /opt/gitlab/service/logrotate/supervise/pid)
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * link[/opt/gitlab/init/logrotate] action create
gitlab-web-1  |       - create symlink at /opt/gitlab/init/logrotate to /opt/gitlab/embedded/bin/sv
gitlab-web-1  |     * file[/opt/gitlab/sv/logrotate/down] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * ruby_block[restart_service] action run (skipped due to only_if)
gitlab-web-1  |     * ruby_block[reload_log_service] action create
gitlab-web-1  |       * ruby_block[restart_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/sv/logrotate] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/logrotate/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/logrotate/log] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/logrotate/log/main] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/logrotate/log/config] action create (up to date)
gitlab-web-1  |       * ruby_block[verify_chown_persisted_on_logrotate] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * link[/var/log/gitlab/logrotate/config] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/logrotate/log/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/logrotate/env] action create (up to date)
gitlab-web-1  |       * ruby_block[Delete unmanaged env files for logrotate service] action run (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/logrotate/check] action create (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/logrotate/finish] action create (skipped due to only_if)
gitlab-web-1  |       * directory[/opt/gitlab/sv/logrotate/control] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/logrotate/control/t] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/init/logrotate] action create (up to date)
gitlab-web-1  |       * file[/opt/gitlab/sv/logrotate/down] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/service] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/service/logrotate] action create
gitlab-web-1  |         - create symlink at /opt/gitlab/service/logrotate to /opt/gitlab/sv/logrotate
gitlab-web-1  |       * ruby_block[wait for logrotate service socket] action run
gitlab-web-1  |         - execute the ruby block wait for logrotate service socket
gitlab-web-1  |       - execute the ruby block reload_log_service
gitlab-web-1  |     * ruby_block[restart_log_service] action run
gitlab-web-1  |       * ruby_block[restart_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/sv/logrotate] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/logrotate/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/logrotate/log] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/logrotate/log/main] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/logrotate/log/config] action create (up to date)
gitlab-web-1  |       * ruby_block[verify_chown_persisted_on_logrotate] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * link[/var/log/gitlab/logrotate/config] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/logrotate/log/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/logrotate/env] action create (up to date)
gitlab-web-1  |       * ruby_block[Delete unmanaged env files for logrotate service] action run (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/logrotate/check] action create (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/logrotate/finish] action create (skipped due to only_if)
gitlab-web-1  |       * directory[/opt/gitlab/sv/logrotate/control] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/logrotate/control/t] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/init/logrotate] action create (up to date)
gitlab-web-1  |       * file[/opt/gitlab/sv/logrotate/down] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/service] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/service/logrotate] action create (up to date)
gitlab-web-1  |       * ruby_block[wait for logrotate service socket] action run (skipped due to not_if)
gitlab-web-1  |       - execute the ruby block restart_log_service
gitlab-web-1  |     * directory[/opt/gitlab/service] action create (up to date)
gitlab-web-1  |     * link[/opt/gitlab/service/logrotate] action create (up to date)
gitlab-web-1  |     * ruby_block[wait for logrotate service socket] action run (skipped due to not_if)
gitlab-web-1  |
gitlab-web-1  |   * execute[/opt/gitlab/bin/gitlab-ctl start logrotate] action run
gitlab-web-1  |     [execute] ok: run: logrotate: (pid 497) 4s
gitlab-web-1  |     - execute /opt/gitlab/bin/gitlab-ctl start logrotate
gitlab-web-1  | Recipe: redis::enable
gitlab-web-1  |   * redis_service[redis] action create
gitlab-web-1  |     * account[user and group for redis] action create (up to date)
gitlab-web-1  |     * group[Socket group] action create (up to date)
gitlab-web-1  |     * directory[/var/opt/gitlab/redis] action create
gitlab-web-1  |       - create new directory /var/opt/gitlab/redis
gitlab-web-1  |       - change mode from '' to '0750'
gitlab-web-1  |       - change owner from '' to 'gitlab-redis'
gitlab-web-1  |       - change group from '' to 'git'
gitlab-web-1  |     * directory[/var/log/gitlab/redis] action create
gitlab-web-1  |       - create new directory /var/log/gitlab/redis
gitlab-web-1  |       - change mode from '' to '0700'
gitlab-web-1  |       - change owner from '' to 'gitlab-redis'
gitlab-web-1  |     * template[/var/opt/gitlab/redis/redis.conf] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/redis/redis.conf
gitlab-web-1  |       - update content in file /var/opt/gitlab/redis/redis.conf from none to d06b8d
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |       - change mode from '' to '0644'
gitlab-web-1  |       - change owner from '' to 'gitlab-redis'
gitlab-web-1  |   Recipe: <Dynamically Defined Resource>
gitlab-web-1  |     * service[redis] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * runit_service[redis] action enable
gitlab-web-1  |       * ruby_block[restart_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/sv/redis] action create
gitlab-web-1  |         - create new directory /opt/gitlab/sv/redis
gitlab-web-1  |         - change mode from '' to '0755'
gitlab-web-1  |         - change owner from '' to 'root'
gitlab-web-1  |         - change group from '' to 'root'
gitlab-web-1  |       * template[/opt/gitlab/sv/redis/run] action create
gitlab-web-1  |         - create new file /opt/gitlab/sv/redis/run
gitlab-web-1  |         - update content in file /opt/gitlab/sv/redis/run from none to da365d
gitlab-web-1  |         --- /opt/gitlab/sv/redis/run    2022-07-28 06:56:41.277080146 +0000
gitlab-web-1  |         +++ /opt/gitlab/sv/redis/.chef-run20220728-35-ix45tk    2022-07-28 06:56:41.277080146 +0000
gitlab-web-1  |         @@ -1 +1,6 @@
gitlab-web-1  |         +#!/bin/sh
gitlab-web-1  |         +exec 2>&1
gitlab-web-1  |         +
gitlab-web-1  |         +umask 077
gitlab-web-1  |         +exec chpst -P -U gitlab-redis:gitlab-redis -u gitlab-redis:gitlab-redis /opt/gitlab/embedded/bin/redis-server /var/opt/gitlab/redis/redis.conf
gitlab-web-1  |         - change mode from '' to '0755'
gitlab-web-1  |         - change owner from '' to 'root'
gitlab-web-1  |         - change group from '' to 'root'
gitlab-web-1  |       * directory[/opt/gitlab/sv/redis/log] action create
gitlab-web-1  |         - create new directory /opt/gitlab/sv/redis/log
gitlab-web-1  |         - change mode from '' to '0755'
gitlab-web-1  |         - change owner from '' to 'root'
gitlab-web-1  |         - change group from '' to 'root'
gitlab-web-1  |       * directory[/opt/gitlab/sv/redis/log/main] action create
gitlab-web-1  |         - create new directory /opt/gitlab/sv/redis/log/main
gitlab-web-1  |         - change mode from '' to '0755'
gitlab-web-1  |         - change owner from '' to 'root'
gitlab-web-1  |         - change group from '' to 'root'
gitlab-web-1  |       * template[/opt/gitlab/sv/redis/log/config] action create
gitlab-web-1  |         - create new file /opt/gitlab/sv/redis/log/config
gitlab-web-1  |         - update content in file /opt/gitlab/sv/redis/log/config from none to 623c00
gitlab-web-1  |         --- /opt/gitlab/sv/redis/log/config     2022-07-28 06:56:41.325081386 +0000
gitlab-web-1  |         +++ /opt/gitlab/sv/redis/log/.chef-config20220728-35-1gz4vvr    2022-07-28 06:56:41.325081386 +0000
gitlab-web-1  |         @@ -1 +1,7 @@
gitlab-web-1  |         +s209715200
gitlab-web-1  |         +n30
gitlab-web-1  |         +t86400
gitlab-web-1  |         +!gzip
gitlab-web-1  |         +
gitlab-web-1  |         +
gitlab-web-1  |         - change mode from '' to '0644'
gitlab-web-1  |         - change owner from '' to 'root'
gitlab-web-1  |         - change group from '' to 'root'
gitlab-web-1  |       * ruby_block[verify_chown_persisted_on_redis] action create
gitlab-web-1  |         - execute the ruby block verify_chown_persisted_on_redis
gitlab-web-1  |       * ruby_block[verify_chown_persisted_on_redis] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * link[/var/log/gitlab/redis/config] action create
gitlab-web-1  |         - create symlink at /var/log/gitlab/redis/config to /opt/gitlab/sv/redis/log/config
gitlab-web-1  |       * template[/opt/gitlab/sv/redis/log/run] action create
gitlab-web-1  |         - create new file /opt/gitlab/sv/redis/log/run
gitlab-web-1  |         - update content in file /opt/gitlab/sv/redis/log/run from none to af1017
gitlab-web-1  |         --- /opt/gitlab/sv/redis/log/run        2022-07-28 06:56:41.361082317 +0000
gitlab-web-1  |         +++ /opt/gitlab/sv/redis/log/.chef-run20220728-35-87ik1s        2022-07-28 06:56:41.357082213 +0000
gitlab-web-1  |         @@ -1 +1,3 @@
gitlab-web-1  |         +#!/bin/sh
gitlab-web-1  |         +exec svlogd -tt /var/log/gitlab/redis
gitlab-web-1  |         - change mode from '' to '0755'
gitlab-web-1  |         - change owner from '' to 'root'
gitlab-web-1  |         - change group from '' to 'root'
gitlab-web-1  |       * directory[/opt/gitlab/sv/redis/env] action create
gitlab-web-1  |         - create new directory /opt/gitlab/sv/redis/env
gitlab-web-1  |         - change mode from '' to '0755'
gitlab-web-1  |         - change owner from '' to 'root'
gitlab-web-1  |         - change group from '' to 'root'
gitlab-web-1  |       * ruby_block[Delete unmanaged env files for redis service] action run (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/redis/check] action create (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/redis/finish] action create (skipped due to only_if)
gitlab-web-1  |       * directory[/opt/gitlab/sv/redis/control] action create
gitlab-web-1  |         - create new directory /opt/gitlab/sv/redis/control
gitlab-web-1  |         - change mode from '' to '0755'
gitlab-web-1  |         - change owner from '' to 'root'
gitlab-web-1  |         - change group from '' to 'root'
gitlab-web-1  |       * link[/opt/gitlab/init/redis] action create
gitlab-web-1  |         - create symlink at /opt/gitlab/init/redis to /opt/gitlab/embedded/bin/sv
gitlab-web-1  |       * file[/opt/gitlab/sv/redis/down] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[restart_service] action run (skipped due to only_if)
gitlab-web-1  |       * ruby_block[reload_log_service] action create
gitlab-web-1  |         * ruby_block[restart_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |         * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |         * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |         * directory[/opt/gitlab/sv/redis] action create (up to date)
gitlab-web-1  |         * template[/opt/gitlab/sv/redis/run] action create (up to date)
gitlab-web-1  |         * directory[/opt/gitlab/sv/redis/log] action create (up to date)
gitlab-web-1  |         * directory[/opt/gitlab/sv/redis/log/main] action create (up to date)
gitlab-web-1  |         * template[/opt/gitlab/sv/redis/log/config] action create (up to date)
gitlab-web-1  |         * ruby_block[verify_chown_persisted_on_redis] action nothing (skipped due to action :nothing)
gitlab-web-1  |         * link[/var/log/gitlab/redis/config] action create (up to date)
gitlab-web-1  |         * template[/opt/gitlab/sv/redis/log/run] action create (up to date)
gitlab-web-1  |         * directory[/opt/gitlab/sv/redis/env] action create (up to date)
gitlab-web-1  |         * ruby_block[Delete unmanaged env files for redis service] action run (skipped due to only_if)
gitlab-web-1  |         * template[/opt/gitlab/sv/redis/check] action create (skipped due to only_if)
gitlab-web-1  |         * template[/opt/gitlab/sv/redis/finish] action create (skipped due to only_if)
gitlab-web-1  |         * directory[/opt/gitlab/sv/redis/control] action create (up to date)
gitlab-web-1  |         * link[/opt/gitlab/init/redis] action create (up to date)
gitlab-web-1  |         * file[/opt/gitlab/sv/redis/down] action nothing (skipped due to action :nothing)
gitlab-web-1  |         * directory[/opt/gitlab/service] action create (up to date)
gitlab-web-1  |         * link[/opt/gitlab/service/redis] action create
gitlab-web-1  |           - create symlink at /opt/gitlab/service/redis to /opt/gitlab/sv/redis
gitlab-web-1  |         * ruby_block[wait for redis service socket] action run
gitlab-web-1  |           - execute the ruby block wait for redis service socket
gitlab-web-1  |         - execute the ruby block reload_log_service
gitlab-web-1  |       * ruby_block[restart_log_service] action run
gitlab-web-1  |         * ruby_block[restart_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |         * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |         * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |         * directory[/opt/gitlab/sv/redis] action create (up to date)
gitlab-web-1  |         * template[/opt/gitlab/sv/redis/run] action create (up to date)
gitlab-web-1  |         * directory[/opt/gitlab/sv/redis/log] action create (up to date)
gitlab-web-1  |         * directory[/opt/gitlab/sv/redis/log/main] action create (up to date)
gitlab-web-1  |         * template[/opt/gitlab/sv/redis/log/config] action create (up to date)
gitlab-web-1  |         * ruby_block[verify_chown_persisted_on_redis] action nothing (skipped due to action :nothing)
gitlab-web-1  |         * link[/var/log/gitlab/redis/config] action create (up to date)
gitlab-web-1  |         * template[/opt/gitlab/sv/redis/log/run] action create (up to date)
gitlab-web-1  |         * directory[/opt/gitlab/sv/redis/env] action create (up to date)
gitlab-web-1  |         * ruby_block[Delete unmanaged env files for redis service] action run (skipped due to only_if)
gitlab-web-1  |         * template[/opt/gitlab/sv/redis/check] action create (skipped due to only_if)
gitlab-web-1  |         * template[/opt/gitlab/sv/redis/finish] action create (skipped due to only_if)
gitlab-web-1  |         * directory[/opt/gitlab/sv/redis/control] action create (up to date)
gitlab-web-1  |         * link[/opt/gitlab/init/redis] action create (up to date)
gitlab-web-1  |         * file[/opt/gitlab/sv/redis/down] action nothing (skipped due to action :nothing)
gitlab-web-1  |         * directory[/opt/gitlab/service] action create (up to date)
gitlab-web-1  |         * link[/opt/gitlab/service/redis] action create (up to date)
gitlab-web-1  |         * ruby_block[wait for redis service socket] action run (skipped due to not_if)
gitlab-web-1  |         - execute the ruby block restart_log_service
gitlab-web-1  |       * directory[/opt/gitlab/service] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/service/redis] action create (up to date)
gitlab-web-1  |       * ruby_block[wait for redis service socket] action run (skipped due to not_if)
gitlab-web-1  |
gitlab-web-1  |     * execute[/opt/gitlab/bin/gitlab-ctl start redis] action run
gitlab-web-1  |       [execute] ok: run: redis: (pid 513) 4s
gitlab-web-1  |       - execute /opt/gitlab/bin/gitlab-ctl start redis
gitlab-web-1  |     * ruby_block[warn pending redis restart] action run (skipped due to only_if)
gitlab-web-1  |
gitlab-web-1  | Recipe: redis::enable
gitlab-web-1  |   * template[/opt/gitlab/etc/gitlab-redis-cli-rc] action create
gitlab-web-1  |     - create new file /opt/gitlab/etc/gitlab-redis-cli-rc
gitlab-web-1  |     - update content in file /opt/gitlab/etc/gitlab-redis-cli-rc from none to 44cac1
gitlab-web-1  |     --- /opt/gitlab/etc/gitlab-redis-cli-rc     2022-07-28 06:56:47.613243849 +0000
gitlab-web-1  |     +++ /opt/gitlab/etc/.chef-gitlab-redis-cli-rc20220728-35-4xb6v3     2022-07-28 06:56:47.613243849 +0000
gitlab-web-1  |     @@ -1 +1,5 @@
gitlab-web-1  |     +redis_dir='/var/opt/gitlab/redis'
gitlab-web-1  |     +redis_host='127.0.0.1'
gitlab-web-1  |     +redis_port='0'
gitlab-web-1  |     +redis_socket='/var/opt/gitlab/redis/redis.socket'
gitlab-web-1  |     - change owner from '' to 'root'
gitlab-web-1  |     - change group from '' to 'root'
gitlab-web-1  | Recipe: gitaly::enable
gitlab-web-1  |   * directory[/var/opt/gitlab/gitaly] action create
gitlab-web-1  |     - create new directory /var/opt/gitlab/gitaly
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |   * directory[/var/opt/gitlab/gitaly/run] action create
gitlab-web-1  |     - create new directory /var/opt/gitlab/gitaly/run
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |   * directory[/var/log/gitlab/gitaly] action create
gitlab-web-1  |     - create new directory /var/log/gitlab/gitaly
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |   * directory[/var/opt/gitlab/gitaly/internal_sockets] action delete (up to date)
gitlab-web-1  |   * env_dir[/opt/gitlab/etc/gitaly/env] action create
gitlab-web-1  |     * directory[/opt/gitlab/etc/gitaly/env] action create
gitlab-web-1  |       - create new directory /opt/gitlab/etc/gitaly/env
gitlab-web-1  |     * file[/opt/gitlab/etc/gitaly/env/HOME] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitaly/env/HOME
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitaly/env/HOME from none to 205bb9
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitaly/env/PATH] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitaly/env/PATH
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitaly/env/PATH from none to d5dc07
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitaly/env/TZ] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitaly/env/TZ
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitaly/env/TZ from none to 983a95
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitaly/env/PYTHONPATH] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitaly/env/PYTHONPATH
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitaly/env/PYTHONPATH from none to 98c9f4
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitaly/env/ICU_DATA] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitaly/env/ICU_DATA
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitaly/env/ICU_DATA from none to a04260
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitaly/env/SSL_CERT_DIR] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitaly/env/SSL_CERT_DIR
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitaly/env/SSL_CERT_DIR from none to 4f45cf
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitaly/env/GITALY_PID_FILE] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitaly/env/GITALY_PID_FILE
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitaly/env/GITALY_PID_FILE from none to e82748
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitaly/env/WRAPPER_JSON_LOGGING] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitaly/env/WRAPPER_JSON_LOGGING
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitaly/env/WRAPPER_JSON_LOGGING from none to b5bea4
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |
gitlab-web-1  |   * template[Create Gitaly config.toml] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/gitaly/config.toml
gitlab-web-1  |     - update content in file /var/opt/gitlab/gitaly/config.toml from none to 51b7e6
gitlab-web-1  |     --- /var/opt/gitlab/gitaly/config.toml      2022-07-28 06:56:47.957252736 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/gitaly/.chef-config20220728-35-sfjx0x.toml      2022-07-28 06:56:47.957252736 +0000
gitlab-web-1  |     @@ -1 +1,57 @@
gitlab-web-1  |     +# Gitaly configuration file
gitlab-web-1  |     +# This file is managed by gitlab-ctl. Manual changes will be
gitlab-web-1  |     +# erased! To change the contents below, edit /etc/gitlab/gitlab.rb
gitlab-web-1  |     +# and run:
gitlab-web-1  |     +# sudo gitlab-ctl reconfigure
gitlab-web-1  |     +
gitlab-web-1  |     +socket_path = '/var/opt/gitlab/gitaly/gitaly.socket'
gitlab-web-1  |     +
gitlab-web-1  |     +runtime_dir = '/var/opt/gitlab/gitaly/run'
gitlab-web-1  |     +bin_dir = '/opt/gitlab/embedded/bin'
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +# Optional: export metrics via Prometheus
gitlab-web-1  |     +prometheus_listen_addr = 'localhost:9236'
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +[[storage]]
gitlab-web-1  |     +name = 'default'
gitlab-web-1  |     +path = '/var/opt/gitlab/git-data/repositories'
gitlab-web-1  |     +
gitlab-web-1  |     +[logging]
gitlab-web-1  |     +format = 'json'
gitlab-web-1  |     +dir = '/var/log/gitlab/gitaly'
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +[auth]
gitlab-web-1  |     +
gitlab-web-1  |     +[git]
gitlab-web-1  |     +bin_path = '/opt/gitlab/embedded/bin/git'
gitlab-web-1  |     +use_bundled_binaries = true
gitlab-web-1  |     +
gitlab-web-1  |     +[gitaly-ruby]
gitlab-web-1  |     +dir = "/opt/gitlab/embedded/service/gitaly-ruby"
gitlab-web-1  |     +rugged_git_config_search_path = "/opt/gitlab/embedded/etc"
gitlab-web-1  |     +
gitlab-web-1  |     +[gitlab-shell]
gitlab-web-1  |     +dir = "/opt/gitlab/embedded/service/gitlab-shell"
gitlab-web-1  |     +
gitlab-web-1  |     +[gitlab]
gitlab-web-1  |     +url = 'http+unix://%2Fvar%2Fopt%2Fgitlab%2Fgitlab-workhorse%2Fsockets%2Fsocket'
gitlab-web-1  |     +relative_url_root = ''
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +[hooks]
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +[daily_maintenance]
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     +
gitlab-web-1  |     - change mode from '' to '0640'
gitlab-web-1  |     - change owner from '' to 'root'
gitlab-web-1  |     - change group from '' to 'git'
gitlab-web-1  |   * service[gitaly] action nothing (skipped due to action :nothing)
gitlab-web-1  |   * runit_service[gitaly] action enable
gitlab-web-1  |     * ruby_block[restart_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * directory[/opt/gitlab/sv/gitaly] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/gitaly
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * template[/opt/gitlab/sv/gitaly/run] action create
gitlab-web-1  |       - create new file /opt/gitlab/sv/gitaly/run
gitlab-web-1  |       - update content in file /opt/gitlab/sv/gitaly/run from none to 7fef11
gitlab-web-1  |       --- /opt/gitlab/sv/gitaly/run     2022-07-28 06:56:48.021254390 +0000
gitlab-web-1  |       +++ /opt/gitlab/sv/gitaly/.chef-run20220728-35-bo0boz     2022-07-28 06:56:48.017254287 +0000
gitlab-web-1  |       @@ -1 +1,20 @@
gitlab-web-1  |       +#!/bin/sh
gitlab-web-1  |       +
gitlab-web-1  |       +# Attempt to change ulimit before the set -e flag, ignore failures
gitlab-web-1  |       +ulimit -n 15000
gitlab-web-1  |       +
gitlab-web-1  |       +set -e # fail on errors
gitlab-web-1  |       +
gitlab-web-1  |       +# Redirect stderr -> stdout
gitlab-web-1  |       +exec 2>&1
gitlab-web-1  |       +
gitlab-web-1  |       +
gitlab-web-1  |       +
gitlab-web-1  |       +
gitlab-web-1  |       +cd /var/opt/gitlab/gitaly
gitlab-web-1  |       +
gitlab-web-1  |       +exec chpst -e /opt/gitlab/etc/gitaly/env -P \
gitlab-web-1  |       +  -U git:git \
gitlab-web-1  |       +  -u git:git \
gitlab-web-1  |       +  /opt/gitlab/embedded/bin/gitaly-wrapper /opt/gitlab/embedded/bin/gitaly /var/opt/gitlab/gitaly/config.toml
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * directory[/opt/gitlab/sv/gitaly/log] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/gitaly/log
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * directory[/opt/gitlab/sv/gitaly/log/main] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/gitaly/log/main
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * template[/opt/gitlab/sv/gitaly/log/config] action create
gitlab-web-1  |       - create new file /opt/gitlab/sv/gitaly/log/config
gitlab-web-1  |       - update content in file /opt/gitlab/sv/gitaly/log/config from none to 623c00
gitlab-web-1  |       --- /opt/gitlab/sv/gitaly/log/config      2022-07-28 06:56:48.057255321 +0000
gitlab-web-1  |       +++ /opt/gitlab/sv/gitaly/log/.chef-config20220728-35-8wery6      2022-07-28 06:56:48.057255321 +0000
gitlab-web-1  |       @@ -1 +1,7 @@
gitlab-web-1  |       +s209715200
gitlab-web-1  |       +n30
gitlab-web-1  |       +t86400
gitlab-web-1  |       +!gzip
gitlab-web-1  |       +
gitlab-web-1  |       +
gitlab-web-1  |       - change mode from '' to '0644'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * ruby_block[verify_chown_persisted_on_gitaly] action create
gitlab-web-1  |       - execute the ruby block verify_chown_persisted_on_gitaly
gitlab-web-1  |     * ruby_block[verify_chown_persisted_on_gitaly] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * link[/var/log/gitlab/gitaly/config] action create
gitlab-web-1  |       - create symlink at /var/log/gitlab/gitaly/config to /opt/gitlab/sv/gitaly/log/config
gitlab-web-1  |     * template[/opt/gitlab/sv/gitaly/log/run] action create
gitlab-web-1  |       - create new file /opt/gitlab/sv/gitaly/log/run
gitlab-web-1  |       - update content in file /opt/gitlab/sv/gitaly/log/run from none to fa6dcc
gitlab-web-1  |       --- /opt/gitlab/sv/gitaly/log/run 2022-07-28 06:56:48.085256044 +0000
gitlab-web-1  |       +++ /opt/gitlab/sv/gitaly/log/.chef-run20220728-35-o27rzw 2022-07-28 06:56:48.085256044 +0000
gitlab-web-1  |       @@ -1 +1,3 @@
gitlab-web-1  |       +#!/bin/sh
gitlab-web-1  |       +exec svlogd /var/log/gitlab/gitaly
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * directory[/opt/gitlab/sv/gitaly/env] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/gitaly/env
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * ruby_block[Delete unmanaged env files for gitaly service] action run (skipped due to only_if)
gitlab-web-1  |     * template[/opt/gitlab/sv/gitaly/check] action create (skipped due to only_if)
gitlab-web-1  |     * template[/opt/gitlab/sv/gitaly/finish] action create (skipped due to only_if)
gitlab-web-1  |     * directory[/opt/gitlab/sv/gitaly/control] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/gitaly/control
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * link[/opt/gitlab/init/gitaly] action create
gitlab-web-1  |       - create symlink at /opt/gitlab/init/gitaly to /opt/gitlab/embedded/bin/sv
gitlab-web-1  |     * file[/opt/gitlab/sv/gitaly/down] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * ruby_block[restart_service] action run (skipped due to only_if)
gitlab-web-1  |     * ruby_block[reload_log_service] action create
gitlab-web-1  |       * ruby_block[restart_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitaly] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitaly/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitaly/log] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitaly/log/main] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitaly/log/config] action create (up to date)
gitlab-web-1  |       * ruby_block[verify_chown_persisted_on_gitaly] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * link[/var/log/gitlab/gitaly/config] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitaly/log/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitaly/env] action create (up to date)
gitlab-web-1  |       * ruby_block[Delete unmanaged env files for gitaly service] action run (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitaly/check] action create (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitaly/finish] action create (skipped due to only_if)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitaly/control] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/init/gitaly] action create (up to date)
gitlab-web-1  |       * file[/opt/gitlab/sv/gitaly/down] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/service] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/service/gitaly] action create
gitlab-web-1  |         - create symlink at /opt/gitlab/service/gitaly to /opt/gitlab/sv/gitaly
gitlab-web-1  |       * ruby_block[wait for gitaly service socket] action run
gitlab-web-1  |         - execute the ruby block wait for gitaly service socket
gitlab-web-1  |       - execute the ruby block reload_log_service
gitlab-web-1  |     * ruby_block[restart_log_service] action run
gitlab-web-1  |       * ruby_block[restart_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitaly] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitaly/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitaly/log] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitaly/log/main] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitaly/log/config] action create (up to date)
gitlab-web-1  |       * ruby_block[verify_chown_persisted_on_gitaly] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * link[/var/log/gitlab/gitaly/config] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitaly/log/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitaly/env] action create (up to date)
gitlab-web-1  |       * ruby_block[Delete unmanaged env files for gitaly service] action run (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitaly/check] action create (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitaly/finish] action create (skipped due to only_if)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitaly/control] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/init/gitaly] action create (up to date)
gitlab-web-1  |       * file[/opt/gitlab/sv/gitaly/down] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/service] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/service/gitaly] action create (up to date)
gitlab-web-1  |       * ruby_block[wait for gitaly service socket] action run (skipped due to not_if)
gitlab-web-1  |       - execute the ruby block restart_log_service
gitlab-web-1  |     * directory[/opt/gitlab/service] action create (up to date)
gitlab-web-1  |     * link[/opt/gitlab/service/gitaly] action create (up to date)
gitlab-web-1  |     * ruby_block[wait for gitaly service socket] action run (skipped due to not_if)
gitlab-web-1  |
gitlab-web-1  |   * execute[/opt/gitlab/bin/gitlab-ctl start gitaly] action run
gitlab-web-1  |     [execute] ok: run: gitaly: (pid 534) 3s
gitlab-web-1  |     - execute /opt/gitlab/bin/gitlab-ctl start gitaly
gitlab-web-1  |   * version_file[Create version file for Gitaly] action create
gitlab-web-1  |     * file[/var/opt/gitlab/gitaly/VERSION] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/gitaly/VERSION
gitlab-web-1  |       - update content in file /var/opt/gitlab/gitaly/VERSION from none to ebdb80
gitlab-web-1  |       --- /var/opt/gitlab/gitaly/VERSION        2022-07-28 06:56:53.497395875 +0000
gitlab-web-1  |       +++ /var/opt/gitlab/gitaly/.chef-VERSION20220728-35-1jzdfv5       2022-07-28 06:56:53.497395875 +0000
gitlab-web-1  |       @@ -1 +1,2 @@
gitlab-web-1  |       +sha256:013ea082503281a3a10ab10e80fd008f8289386319b19b649756f58126423687
gitlab-web-1  |
gitlab-web-1  |   * version_file[Create Ruby version file for Gitaly] action create
gitlab-web-1  |     * file[/var/opt/gitlab/gitaly/RUBY_VERSION] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/gitaly/RUBY_VERSION
gitlab-web-1  |       - update content in file /var/opt/gitlab/gitaly/RUBY_VERSION from none to 47ac47
gitlab-web-1  |       --- /var/opt/gitlab/gitaly/RUBY_VERSION   2022-07-28 06:56:53.665400216 +0000
gitlab-web-1  |       +++ /var/opt/gitlab/gitaly/.chef-RUBY_VERSION20220728-35-1e0yeeu  2022-07-28 06:56:53.665400216 +0000
gitlab-web-1  |       @@ -1 +1,2 @@
gitlab-web-1  |       +ruby 2.7.5p203 (2021-11-24 revision f69aeb8314) [x86_64-linux]
gitlab-web-1  |
gitlab-web-1  |   * consul_service[gitaly] action delete
gitlab-web-1  |     * file[/var/opt/gitlab/consul/config.d/gitaly-service.json] action delete (up to date)
gitlab-web-1  |      (up to date)
gitlab-web-1  | Recipe: postgresql::bin
gitlab-web-1  |   * ruby_block[check_postgresql_version] action run (skipped due to not_if)
gitlab-web-1  |   * ruby_block[check_postgresql_version_is_deprecated] action run (skipped due to not_if)
gitlab-web-1  |   * ruby_block[Link postgresql bin files to the correct version] action run
gitlab-web-1  |     - execute the ruby block Link postgresql bin files to the correct version
gitlab-web-1  |   * template[/opt/gitlab/etc/gitlab-psql-rc] action create
gitlab-web-1  |     - create new file /opt/gitlab/etc/gitlab-psql-rc
gitlab-web-1  |     - update content in file /opt/gitlab/etc/gitlab-psql-rc from none to b7b8fc
gitlab-web-1  |     - suppressed sensitive resource
gitlab-web-1  |     - change owner from '' to 'root'
gitlab-web-1  |     - change group from '' to 'root'
gitlab-web-1  | Recipe: postgresql::user
gitlab-web-1  |   * account[Postgresql user and group] action create (up to date)
gitlab-web-1  |   * directory[/var/opt/gitlab/postgresql] action create
gitlab-web-1  |     - create new directory /var/opt/gitlab/postgresql
gitlab-web-1  |     - change mode from '' to '0755'
gitlab-web-1  |     - change owner from '' to 'gitlab-psql'
gitlab-web-1  |   * file[/var/opt/gitlab/postgresql/.profile] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/postgresql/.profile
gitlab-web-1  |     - update content in file /var/opt/gitlab/postgresql/.profile from none to 3b0387
gitlab-web-1  |     --- /var/opt/gitlab/postgresql/.profile     2022-07-28 06:56:53.845404866 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/postgresql/.chef-.profile20220728-35-1o6wn0x.profile    2022-07-28 06:56:53.845404866 +0000
gitlab-web-1  |     @@ -1 +1,2 @@
gitlab-web-1  |     +PATH=/opt/gitlab/embedded/bin:/opt/gitlab/bin:$PATH
gitlab-web-1  |     - change mode from '' to '0600'
gitlab-web-1  |     - change owner from '' to 'gitlab-psql'
gitlab-web-1  | Recipe: postgresql::sysctl
gitlab-web-1  |   * gitlab_sysctl[kernel.shmmax] action create
gitlab-web-1  |     * directory[create /etc/sysctl.d for kernel.shmmax] action create (skipped due to only_if)
gitlab-web-1  |     * file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf kernel.shmmax] action create (skipped due to only_if)
gitlab-web-1  |     * link[/etc/sysctl.d/90-omnibus-gitlab-kernel.shmmax.conf] action create (skipped due to only_if)
gitlab-web-1  |     * execute[load sysctl conf kernel.shmmax] action nothing (skipped due to action :nothing)
gitlab-web-1  |      (up to date)
gitlab-web-1  |   * gitlab_sysctl[kernel.shmall] action create
gitlab-web-1  |     * directory[create /etc/sysctl.d for kernel.shmall] action create (skipped due to only_if)
gitlab-web-1  |     * file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf kernel.shmall] action create (skipped due to only_if)
gitlab-web-1  |     * link[/etc/sysctl.d/90-omnibus-gitlab-kernel.shmall.conf] action create (skipped due to only_if)
gitlab-web-1  |     * execute[load sysctl conf kernel.shmall] action nothing (skipped due to action :nothing)
gitlab-web-1  |      (up to date)
gitlab-web-1  |   * gitlab_sysctl[kernel.sem] action create
gitlab-web-1  |     * directory[create /etc/sysctl.d for kernel.sem] action create (skipped due to only_if)
gitlab-web-1  |     * file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf kernel.sem] action create (skipped due to only_if)
gitlab-web-1  |     * link[/etc/sysctl.d/90-omnibus-gitlab-kernel.sem.conf] action create (skipped due to only_if)
gitlab-web-1  |     * execute[load sysctl conf kernel.sem] action nothing (skipped due to action :nothing)
gitlab-web-1  |      (up to date)
gitlab-web-1  | Recipe: postgresql::enable
gitlab-web-1  |   * directory[/var/opt/gitlab/postgresql] action create (up to date)
gitlab-web-1  |   * directory[/var/opt/gitlab/postgresql/data] action create
gitlab-web-1  |     - create new directory /var/opt/gitlab/postgresql/data
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'gitlab-psql'
gitlab-web-1  |   * directory[/var/log/gitlab/postgresql] action create
gitlab-web-1  |     - create new directory /var/log/gitlab/postgresql
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'gitlab-psql'
gitlab-web-1  |   * directory[/var/opt/gitlab/postgresql/data] action create (up to date)
gitlab-web-1  |   * execute[/opt/gitlab/embedded/bin/initdb -D /var/opt/gitlab/postgresql/data -E UTF8] action run
gitlab-web-1  |     [execute] The files belonging to this database system will be owned by user "gitlab-psql".
gitlab-web-1  |               This user must also own the server process.
gitlab-web-1  |
gitlab-web-1  |               The database cluster will be initialized with locale "C.UTF-8".
gitlab-web-1  |               The default text search configuration will be set to "english".
gitlab-web-1  |
gitlab-web-1  |               Data page checksums are disabled.
gitlab-web-1  |
gitlab-web-1  |               fixing permissions on existing directory /var/opt/gitlab/postgresql/data ... ok
gitlab-web-1  |               creating subdirectories ... ok
gitlab-web-1  |               selecting dynamic shared memory implementation ... posix
gitlab-web-1  |               selecting default max_connections ... 100
gitlab-web-1  |               selecting default shared_buffers ... 128MB
gitlab-web-1  |               selecting default time zone ... Etc/UTC
gitlab-web-1  |               creating configuration files ... ok
gitlab-web-1  |               running bootstrap script ... ok
gitlab-web-1  |               performing post-bootstrap initialization ... ok
gitlab-web-1  |               syncing data to disk ... ok
gitlab-web-1  |
gitlab-web-1  |
gitlab-web-1  |               Success. You can now start the database server using:
gitlab-web-1  |
gitlab-web-1  |                   /opt/gitlab/embedded/bin/pg_ctl -D /var/opt/gitlab/postgresql/data -l logfile start
gitlab-web-1  |
gitlab-web-1  |               initdb: warning: enabling "trust" authentication for local connections
gitlab-web-1  |               You can change this by editing pg_hba.conf or using the option -A, or
gitlab-web-1  |               --auth-local and --auth-host, the next time you run initdb.
gitlab-web-1  |     - execute /opt/gitlab/embedded/bin/initdb -D /var/opt/gitlab/postgresql/data -E UTF8
gitlab-web-1  |   * file[/var/opt/gitlab/postgresql/data/server.crt] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/postgresql/data/server.crt
gitlab-web-1  |     - update content in file /var/opt/gitlab/postgresql/data/server.crt from none to c7fe75
gitlab-web-1  |     - suppressed sensitive resource
gitlab-web-1  |     - change mode from '' to '0400'
gitlab-web-1  |     - change owner from '' to 'gitlab-psql'
gitlab-web-1  |     - change group from '' to 'gitlab-psql'
gitlab-web-1  |   * file[/var/opt/gitlab/postgresql/data/server.key] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/postgresql/data/server.key
gitlab-web-1  |     - update content in file /var/opt/gitlab/postgresql/data/server.key from none to ffceb8
gitlab-web-1  |     - suppressed sensitive resource
gitlab-web-1  |     - change mode from '' to '0400'
gitlab-web-1  |     - change owner from '' to 'gitlab-psql'
gitlab-web-1  |     - change group from '' to 'gitlab-psql'
gitlab-web-1  |   * postgresql_config[gitlab] action create
gitlab-web-1  |     * template[/var/opt/gitlab/postgresql/data/postgresql.conf] action create
gitlab-web-1  |       - update content in file /var/opt/gitlab/postgresql/data/postgresql.conf from 385c8b to 290c4d
gitlab-web-1  |       --- /var/opt/gitlab/postgresql/data/postgresql.conf       2022-07-28 06:56:54.109411687 +0000
gitlab-web-1  |       +++ /var/opt/gitlab/postgresql/data/.chef-postgresql20220728-35-vfwqre.conf       2022-07-28 06:56:55.529448377 +0000
gitlab-web-1  |       @@ -1,3 +1,7 @@
gitlab-web-1  |       +# This file is managed by gitlab-ctl. Manual changes will be
gitlab-web-1  |       +# erased! To change the contents below, edit /etc/gitlab/gitlab.rb
gitlab-web-1  |       +# and run `sudo gitlab-ctl reconfigure`.
gitlab-web-1  |       +
gitlab-web-1  |        # -----------------------------
gitlab-web-1  |        # PostgreSQL configuration file
gitlab-web-1  |        # -----------------------------
gitlab-web-1  |       @@ -16,9 +20,9 @@
gitlab-web-1  |        #
gitlab-web-1  |        # This file is read on server startup and when the server receives a SIGHUP
gitlab-web-1  |        # signal.  If you edit the file on a running system, you have to SIGHUP the
gitlab-web-1  |       -# server for the changes to take effect, run "pg_ctl reload", or execute
gitlab-web-1  |       -# "SELECT pg_reload_conf()".  Some parameters, which are marked below,
gitlab-web-1  |       -# require a server shutdown and restart to take effect.
gitlab-web-1  |       +# server for the changes to take effect, or use "pg_ctl reload".  Some
gitlab-web-1  |       +# parameters, which are marked below, require a server shutdown and restart to
gitlab-web-1  |       +# take effect.
gitlab-web-1  |        #
gitlab-web-1  |        # Any parameter can also be given as a command-line option to the server, e.g.,
gitlab-web-1  |        # "postgres -c log_connections=on".  Some parameters can be changed at run time
gitlab-web-1  |       @@ -27,7 +31,7 @@
gitlab-web-1  |        # Memory units:  kB = kilobytes        Time units:  ms  = milliseconds
gitlab-web-1  |        #                MB = megabytes                     s   = seconds
gitlab-web-1  |        #                GB = gigabytes                     min = minutes
gitlab-web-1  |       -#                TB = terabytes                     h   = hours
gitlab-web-1  |       +#                                                   h   = hours
gitlab-web-1  |        #                                                   d   = days
gitlab-web-1  |
gitlab-web-1  |
gitlab-web-1  |       @@ -38,16 +42,16 @@
gitlab-web-1  |        # The default values of these variables are driven from the -D command-line
gitlab-web-1  |        # option or PGDATA environment variable, represented here as ConfigDir.
gitlab-web-1  |
gitlab-web-1  |       -#data_directory = 'ConfigDir'            # use data in another directory
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#hba_file = 'ConfigDir/pg_hba.conf'      # host-based authentication file
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#ident_file = 'ConfigDir/pg_ident.conf'  # ident configuration file
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       +#data_directory = 'ConfigDir'   # use data in another directory
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |       +#hba_file = 'ConfigDir/pg_hba.conf' # host-based authentication file
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |       +#ident_file = 'ConfigDir/pg_ident.conf' # ident configuration file
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |
gitlab-web-1  |        # If external_pid_file is not explicitly set, no extra PID file is written.
gitlab-web-1  |       -#external_pid_file = ''                  # write an extra PID file
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       +#external_pid_file = '(none)'   # write an extra PID file
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |
gitlab-web-1  |
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |       @@ -56,60 +60,57 @@
gitlab-web-1  |
gitlab-web-1  |        # - Connection Settings -
gitlab-web-1  |
gitlab-web-1  |       -#listen_addresses = 'localhost'          # what IP address(es) to listen on;
gitlab-web-1  |       -                                 # comma-separated list of addresses;
gitlab-web-1  |       -                                 # defaults to 'localhost'; use '*' for all
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#port = 5432                             # (change requires restart)
gitlab-web-1  |       -max_connections = 100                    # (change requires restart)
gitlab-web-1  |       -#superuser_reserved_connections = 3      # (change requires restart)
gitlab-web-1  |       -#unix_socket_directories = '/tmp'        # comma-separated list of directories
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#unix_socket_group = ''                  # (change requires restart)
gitlab-web-1  |       -#unix_socket_permissions = 0777          # begin with 0 to use octal notation
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#bonjour = off                           # advertise server via Bonjour
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#bonjour_name = ''                       # defaults to the computer name
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       +listen_addresses = ''    # what IP address(es) to listen on;
gitlab-web-1  |       +          # comma-separated list of addresses;
gitlab-web-1  |       +          # defaults to 'localhost', '*' = all
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |       +port = 5432        # (change requires restart)
gitlab-web-1  |       +max_connections = 200      # (change requires restart)
gitlab-web-1  |       +# Note:  Increasing max_connections costs ~400 bytes of shared memory per
gitlab-web-1  |       +# connection slot, plus lock space (see max_locks_per_transaction).
gitlab-web-1  |       +#superuser_reserved_connections = 3 # (change requires restart)
gitlab-web-1  |       +unix_socket_directories = '/var/opt/gitlab/postgresql'   # (change requires restart)
gitlab-web-1  |       +#unix_socket_group = ''     # (change requires restart)
gitlab-web-1  |       +#unix_socket_permissions = 0777   # begin with 0 to use octal notation
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |       +#bonjour = off        # advertise server via Bonjour
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |       +#bonjour_name = ''      # defaults to the computer name
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |
gitlab-web-1  |       -# - TCP settings -
gitlab-web-1  |       -# see "man 7 tcp" for details
gitlab-web-1  |       +# - Security and Authentication -
gitlab-web-1  |
gitlab-web-1  |       -#tcp_keepalives_idle = 0         # TCP_KEEPIDLE, in seconds;
gitlab-web-1  |       -                                 # 0 selects the system default
gitlab-web-1  |       -#tcp_keepalives_interval = 0             # TCP_KEEPINTVL, in seconds;
gitlab-web-1  |       -                                 # 0 selects the system default
gitlab-web-1  |       -#tcp_keepalives_count = 0                # TCP_KEEPCNT;
gitlab-web-1  |       -                                 # 0 selects the system default
gitlab-web-1  |       -#tcp_user_timeout = 0                    # TCP_USER_TIMEOUT, in milliseconds;
gitlab-web-1  |       -                                 # 0 selects the system default
gitlab-web-1  |       +#authentication_timeout = 1min    # 1s-600s
gitlab-web-1  |
gitlab-web-1  |       -# - Authentication -
gitlab-web-1  |       +# change requires restart
gitlab-web-1  |       +ssl = on
gitlab-web-1  |
gitlab-web-1  |       -#authentication_timeout = 1min           # 1s-600s
gitlab-web-1  |       -#password_encryption = md5               # md5 or scram-sha-256
gitlab-web-1  |       +# allowed SSL ciphers
gitlab-web-1  |       +ssl_ciphers = 'HIGH:MEDIUM:+3DES:!aNULL:!SSLv3:!TLSv1'
gitlab-web-1  |       +
gitlab-web-1  |       +ssl_cert_file = 'server.crt'
gitlab-web-1  |       +ssl_key_file = 'server.key'
gitlab-web-1  |       +ssl_ca_file = '/opt/gitlab/embedded/ssl/certs/cacert.pem'
gitlab-web-1  |       +
gitlab-web-1  |       +
gitlab-web-1  |       +#ssl_renegotiation_limit = 512MB  # amount of data between renegotiations
gitlab-web-1  |       +#password_encryption = on
gitlab-web-1  |        #db_user_namespace = off
gitlab-web-1  |
gitlab-web-1  |       -# GSSAPI using Kerberos
gitlab-web-1  |       -#krb_server_keyfile = 'FILE:${sysconfdir}/krb5.keytab'
gitlab-web-1  |       +# Kerberos and GSSAPI
gitlab-web-1  |       +#krb_server_keyfile = ''
gitlab-web-1  |       +#krb_srvname = 'postgres'   # (Kerberos only)
gitlab-web-1  |        #krb_caseins_users = off
gitlab-web-1  |
gitlab-web-1  |       -# - SSL -
gitlab-web-1  |       +# - TCP Keepalives -
gitlab-web-1  |       +# see "man 7 tcp" for details
gitlab-web-1  |
gitlab-web-1  |       -#ssl = off
gitlab-web-1  |       -#ssl_ca_file = ''
gitlab-web-1  |       -#ssl_cert_file = 'server.crt'
gitlab-web-1  |       -#ssl_crl_file = ''
gitlab-web-1  |       -#ssl_key_file = 'server.key'
gitlab-web-1  |       -#ssl_ciphers = 'HIGH:MEDIUM:+3DES:!aNULL' # allowed SSL ciphers
gitlab-web-1  |       -#ssl_prefer_server_ciphers = on
gitlab-web-1  |       -#ssl_ecdh_curve = 'prime256v1'
gitlab-web-1  |       -#ssl_min_protocol_version = 'TLSv1'
gitlab-web-1  |       -#ssl_max_protocol_version = ''
gitlab-web-1  |       -#ssl_dh_params_file = ''
gitlab-web-1  |       -#ssl_passphrase_command = ''
gitlab-web-1  |       -#ssl_passphrase_command_supports_reload = off
gitlab-web-1  |       +#tcp_keepalives_idle = 0    # TCP_KEEPIDLE, in seconds;
gitlab-web-1  |       +          # 0 selects the system default
gitlab-web-1  |       +#tcp_keepalives_interval = 0    # TCP_KEEPINTVL, in seconds;
gitlab-web-1  |       +          # 0 selects the system default
gitlab-web-1  |       +#tcp_keepalives_count = 0   # TCP_KEEPCNT;
gitlab-web-1  |       +          # 0 selects the system default
gitlab-web-1  |
gitlab-web-1  |
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |       @@ -118,228 +119,105 @@
gitlab-web-1  |
gitlab-web-1  |        # - Memory -
gitlab-web-1  |
gitlab-web-1  |       -shared_buffers = 128MB                   # min 128kB
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#huge_pages = try                        # on, off, or try
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#temp_buffers = 8MB                      # min 800kB
gitlab-web-1  |       -#max_prepared_transactions = 0           # zero disables the feature
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -# Caution: it is not advisable to set max_prepared_transactions nonzero unless
gitlab-web-1  |       -# you actively intend to use prepared transactions.
gitlab-web-1  |       -#work_mem = 4MB                          # min 64kB
gitlab-web-1  |       -#maintenance_work_mem = 64MB             # min 1MB
gitlab-web-1  |       -#autovacuum_work_mem = -1                # min 1MB, or -1 to use maintenance_work_mem
gitlab-web-1  |       -#max_stack_depth = 2MB                   # min 100kB
gitlab-web-1  |       -#shared_memory_type = mmap               # the default is the first option
gitlab-web-1  |       -                                 # supported by the operating system:
gitlab-web-1  |       -                                 #   mmap
gitlab-web-1  |       -                                 #   sysv
gitlab-web-1  |       -                                 #   windows
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -dynamic_shared_memory_type = posix       # the default is the first option
gitlab-web-1  |       -                                 # supported by the operating system:
gitlab-web-1  |       -                                 #   posix
gitlab-web-1  |       -                                 #   sysv
gitlab-web-1  |       -                                 #   windows
gitlab-web-1  |       -                                 #   mmap
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       +shared_buffers = 1MB # min 128kB
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |       +#temp_buffers = 8MB     # min 800kB
gitlab-web-1  |       +#max_prepared_transactions = 0    # zero disables the feature
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |       +# Note:  Increasing max_prepared_transactions costs ~600 bytes of shared memory
gitlab-web-1  |       +# per transaction slot, plus lock space (see max_locks_per_transaction).
gitlab-web-1  |       +# It is not advisable to set max_prepared_transactions nonzero unless you
gitlab-web-1  |       +# actively intend to use prepared transactions.
gitlab-web-1  |       +#max_stack_depth = 2MB      # min 100kB
gitlab-web-1  |
gitlab-web-1  |       -# - Disk -
gitlab-web-1  |       +# - Kernel Resource Usage -
gitlab-web-1  |
gitlab-web-1  |       -#temp_file_limit = -1                    # limits per-process temp file space
gitlab-web-1  |       -                                 # in kB, or -1 for no limit
gitlab-web-1  |       +#max_files_per_process = 1000   # min 25
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |       +shared_preload_libraries = ''    # (change requires restart)
gitlab-web-1  |
gitlab-web-1  |       -# - Kernel Resources -
gitlab-web-1  |       -
gitlab-web-1  |       -#max_files_per_process = 1000            # min 25
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -
gitlab-web-1  |        # - Cost-Based Vacuum Delay -
gitlab-web-1  |
gitlab-web-1  |       -#vacuum_cost_delay = 0                   # 0-100 milliseconds (0 disables)
gitlab-web-1  |       -#vacuum_cost_page_hit = 1                # 0-10000 credits
gitlab-web-1  |       -#vacuum_cost_page_miss = 10              # 0-10000 credits
gitlab-web-1  |       -#vacuum_cost_page_dirty = 20             # 0-10000 credits
gitlab-web-1  |       -#vacuum_cost_limit = 200         # 1-10000 credits
gitlab-web-1  |       +#vacuum_cost_delay = 0ms    # 0-100 milliseconds
gitlab-web-1  |       +#vacuum_cost_page_hit = 1   # 0-10000 credits
gitlab-web-1  |       +#vacuum_cost_page_miss = 10   # 0-10000 credits
gitlab-web-1  |       +#vacuum_cost_page_dirty = 20    # 0-10000 credits
gitlab-web-1  |       +#vacuum_cost_limit = 200    # 1-10000 credits
gitlab-web-1  |
gitlab-web-1  |        # - Background Writer -
gitlab-web-1  |
gitlab-web-1  |       -#bgwriter_delay = 200ms                  # 10-10000ms between rounds
gitlab-web-1  |       -#bgwriter_lru_maxpages = 100             # max buffers written/round, 0 disables
gitlab-web-1  |       -#bgwriter_lru_multiplier = 2.0           # 0-10.0 multiplier on buffers scanned/round
gitlab-web-1  |       -#bgwriter_flush_after = 512kB            # measured in pages, 0 disables
gitlab-web-1  |       +#bgwriter_delay = 200ms     # 10-10000ms between rounds
gitlab-web-1  |       +#bgwriter_lru_maxpages = 100    # 0-1000 max buffers written/round
gitlab-web-1  |       +#bgwriter_lru_multiplier = 2.0    # 0-10.0 multipler on buffers scanned/round
gitlab-web-1  |
gitlab-web-1  |        # - Asynchronous Behavior -
gitlab-web-1  |
gitlab-web-1  |       -#effective_io_concurrency = 1            # 1-1000; 0 disables prefetching
gitlab-web-1  |       -#max_worker_processes = 8                # (change requires restart)
gitlab-web-1  |       -#max_parallel_maintenance_workers = 2    # taken from max_parallel_workers
gitlab-web-1  |       -#max_parallel_workers_per_gather = 2     # taken from max_parallel_workers
gitlab-web-1  |       -#parallel_leader_participation = on
gitlab-web-1  |       -#max_parallel_workers = 8                # maximum number of max_worker_processes that
gitlab-web-1  |       -                                 # can be used in parallel operations
gitlab-web-1  |       -#old_snapshot_threshold = -1             # 1min-60d; -1 disables; 0 is immediate
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#backend_flush_after = 0         # measured in pages, 0 disables
gitlab-web-1  |       +#effective_io_concurrency = 1   # 1-1000. 0 disables prefetching
gitlab-web-1  |
gitlab-web-1  |
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |       -# WRITE-AHEAD LOG
gitlab-web-1  |       +# WRITE AHEAD LOG
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |
gitlab-web-1  |        # - Settings -
gitlab-web-1  |
gitlab-web-1  |       -#wal_level = replica                     # minimal, replica, or logical
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#fsync = on                              # flush data to disk for crash safety
gitlab-web-1  |       -                                 # (turning this off can cause
gitlab-web-1  |       -                                 # unrecoverable data corruption)
gitlab-web-1  |       -#synchronous_commit = on         # synchronization level;
gitlab-web-1  |       -                                 # off, local, remote_write, remote_apply, or on
gitlab-web-1  |       -#wal_sync_method = fsync         # the default is the first option
gitlab-web-1  |       -                                 # supported by the operating system:
gitlab-web-1  |       -                                 #   open_datasync
gitlab-web-1  |       -                                 #   fdatasync (default on Linux and FreeBSD)
gitlab-web-1  |       -                                 #   fsync
gitlab-web-1  |       -                                 #   fsync_writethrough
gitlab-web-1  |       -                                 #   open_sync
gitlab-web-1  |       -#full_page_writes = on                   # recover from partial page writes
gitlab-web-1  |       -#wal_compression = off                   # enable compression of full-page writes
gitlab-web-1  |       -#wal_log_hints = off                     # also do full page writes of non-critical updates
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#wal_init_zero = on                      # zero-fill new WAL files
gitlab-web-1  |       -#wal_recycle = on                        # recycle WAL files
gitlab-web-1  |       -#wal_buffers = -1                        # min 32kB, -1 sets based on shared_buffers
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#wal_writer_delay = 200ms                # 1-10000 milliseconds
gitlab-web-1  |       -#wal_writer_flush_after = 1MB            # measured in pages, 0 disables
gitlab-web-1  |       +wal_level = minimal
gitlab-web-1  |       +wal_log_hints = off      # also do full page writes of non-critical updates
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |       +#fsync = on       # turns forced synchronization on or off
gitlab-web-1  |       +#wal_sync_method = fsync    # the default is the first option
gitlab-web-1  |       +          # supported by the operating system:
gitlab-web-1  |       +          #   open_datasync
gitlab-web-1  |       +          #   fdatasync (default on Linux)
gitlab-web-1  |       +          #   fsync
gitlab-web-1  |       +          #   fsync_writethrough
gitlab-web-1  |       +          #   open_sync
gitlab-web-1  |       +#full_page_writes = on      # recover from partial page writes
gitlab-web-1  |       +wal_buffers = -1 # -1     # min 32kB, -1 sets based on shared_buffers
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |       +#wal_writer_delay = 200ms   # 1-10000 milliseconds
gitlab-web-1  |
gitlab-web-1  |       -#commit_delay = 0                        # range 0-100000, in microseconds
gitlab-web-1  |       -#commit_siblings = 5                     # range 1-1000
gitlab-web-1  |       +#commit_delay = 0     # range 0-100000, in microseconds
gitlab-web-1  |       +#commit_siblings = 5      # range 1-1000
gitlab-web-1  |
gitlab-web-1  |       -# - Checkpoints -
gitlab-web-1  |       -
gitlab-web-1  |       -#checkpoint_timeout = 5min               # range 30s-1d
gitlab-web-1  |       -max_wal_size = 1GB
gitlab-web-1  |        min_wal_size = 80MB
gitlab-web-1  |       -#checkpoint_completion_target = 0.5      # checkpoint target duration, 0.0 - 1.0
gitlab-web-1  |       -#checkpoint_flush_after = 256kB          # measured in pages, 0 disables
gitlab-web-1  |       -#checkpoint_warning = 30s                # 0 disables
gitlab-web-1  |       +max_wal_size = 1GB
gitlab-web-1  |
gitlab-web-1  |       -# - Archiving -
gitlab-web-1  |       +# The number of replication slots to reserve.
gitlab-web-1  |       +max_replication_slots = 0
gitlab-web-1  |
gitlab-web-1  |       -#archive_mode = off              # enables archiving; off, on, or always
gitlab-web-1  |       -                         # (change requires restart)
gitlab-web-1  |       -#archive_command = ''            # command to use to archive a logfile segment
gitlab-web-1  |       -                         # placeholders: %p = path of file to archive
gitlab-web-1  |       -                         #               %f = file name only
gitlab-web-1  |       -                         # e.g. 'test ! -f /mnt/server/archivedir/%f && cp %p /mnt/server/archivedir/%f'
gitlab-web-1  |       -#archive_timeout = 0             # force a logfile segment switch after this
gitlab-web-1  |       -                         # number of seconds; 0 disables
gitlab-web-1  |
gitlab-web-1  |       -# - Archive Recovery -
gitlab-web-1  |       +# - Archiving -
gitlab-web-1  |
gitlab-web-1  |       -# These are only used in recovery mode.
gitlab-web-1  |       +archive_mode = off   # allows archiving to be done
gitlab-web-1  |       +        # (change requires restart, also requires 'wal_level' of 'hot_standby' OR 'replica')
gitlab-web-1  |
gitlab-web-1  |       -#restore_command = ''            # command to use to restore an archived logfile segment
gitlab-web-1  |       -                         # placeholders: %p = path of file to restore
gitlab-web-1  |       -                         #               %f = file name only
gitlab-web-1  |       -                         # e.g. 'cp /mnt/server/archivedir/%f %p'
gitlab-web-1  |       -                         # (change requires restart)
gitlab-web-1  |       -#archive_cleanup_command = ''    # command to execute at every restartpoint
gitlab-web-1  |       -#recovery_end_command = ''       # command to execute at completion of recovery
gitlab-web-1  |       -
gitlab-web-1  |       -# - Recovery Target -
gitlab-web-1  |       -
gitlab-web-1  |       -# Set these only when performing a targeted recovery.
gitlab-web-1  |       -
gitlab-web-1  |       -#recovery_target = ''            # 'immediate' to end recovery as soon as a
gitlab-web-1  |       -                                # consistent state is reached
gitlab-web-1  |       -                         # (change requires restart)
gitlab-web-1  |       -#recovery_target_name = ''       # the named restore point to which recovery will proceed
gitlab-web-1  |       -                         # (change requires restart)
gitlab-web-1  |       -#recovery_target_time = ''       # the time stamp up to which recovery will proceed
gitlab-web-1  |       -                         # (change requires restart)
gitlab-web-1  |       -#recovery_target_xid = ''        # the transaction ID up to which recovery will proceed
gitlab-web-1  |       -                         # (change requires restart)
gitlab-web-1  |       -#recovery_target_lsn = ''        # the WAL LSN up to which recovery will proceed
gitlab-web-1  |       -                         # (change requires restart)
gitlab-web-1  |       -#recovery_target_inclusive = on # Specifies whether to stop:
gitlab-web-1  |       -                         # just after the specified recovery target (on)
gitlab-web-1  |       -                         # just before the recovery target (off)
gitlab-web-1  |       -                         # (change requires restart)
gitlab-web-1  |       -#recovery_target_timeline = 'latest'     # 'current', 'latest', or timeline ID
gitlab-web-1  |       -                         # (change requires restart)
gitlab-web-1  |       -#recovery_target_action = 'pause'        # 'pause', 'promote', 'shutdown'
gitlab-web-1  |       -                         # (change requires restart)
gitlab-web-1  |       -
gitlab-web-1  |       -
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |        # REPLICATION
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |
gitlab-web-1  |       -# - Sending Servers -
gitlab-web-1  |       -
gitlab-web-1  |       -# Set these on the master and on any standby that will send replication data.
gitlab-web-1  |       -
gitlab-web-1  |       -#max_wal_senders = 10            # max number of walsender processes
gitlab-web-1  |       -                         # (change requires restart)
gitlab-web-1  |       -#wal_keep_segments = 0           # in logfile segments; 0 disables
gitlab-web-1  |       -#wal_sender_timeout = 60s        # in milliseconds; 0 disables
gitlab-web-1  |       -
gitlab-web-1  |       -#max_replication_slots = 10      # max number of replication slots
gitlab-web-1  |       -                         # (change requires restart)
gitlab-web-1  |       -#track_commit_timestamp = off    # collect timestamp of transaction commit
gitlab-web-1  |       -                         # (change requires restart)
gitlab-web-1  |       -
gitlab-web-1  |        # - Master Server -
gitlab-web-1  |
gitlab-web-1  |       -# These settings are ignored on a standby server.
gitlab-web-1  |       +# These settings are ignored on a standby server
gitlab-web-1  |
gitlab-web-1  |       -#synchronous_standby_names = ''  # standby servers that provide sync rep
gitlab-web-1  |       -                         # method to choose sync standbys, number of sync standbys,
gitlab-web-1  |       -                         # and comma-separated list of application_name
gitlab-web-1  |       -                         # from standby(s); '*' = all
gitlab-web-1  |       -#vacuum_defer_cleanup_age = 0    # number of xacts by which cleanup is delayed
gitlab-web-1  |       +max_wal_senders = 0
gitlab-web-1  |       +        # (change requires restart)
gitlab-web-1  |       +#wal_sender_delay = 1s    # walsender cycle time, 1-10000 milliseconds
gitlab-web-1  |       +#vacuum_defer_cleanup_age = 0 # number of xacts by which cleanup is delayed
gitlab-web-1  |       +#replication_timeout = 60s  # in milliseconds; 0 disables
gitlab-web-1  |       +#synchronous_standby_names = '' # standby servers that provide sync rep
gitlab-web-1  |       +        # comma-separated list of application_name
gitlab-web-1  |       +        # from standby(s); '*' = all
gitlab-web-1  |
gitlab-web-1  |        # - Standby Servers -
gitlab-web-1  |
gitlab-web-1  |       -# These settings are ignored on a master server.
gitlab-web-1  |       +# These settings are ignored on a master server
gitlab-web-1  |
gitlab-web-1  |       -#primary_conninfo = ''                   # connection string to sending server
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#primary_slot_name = ''                  # replication slot on sending server
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#promote_trigger_file = ''               # file name whose presence ends recovery
gitlab-web-1  |       -#hot_standby = on                        # "off" disallows queries during recovery
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#max_standby_archive_delay = 30s # max delay before canceling queries
gitlab-web-1  |       -                                 # when reading WAL from archive;
gitlab-web-1  |       -                                 # -1 allows indefinite delay
gitlab-web-1  |       -#max_standby_streaming_delay = 30s       # max delay before canceling queries
gitlab-web-1  |       -                                 # when reading streaming WAL;
gitlab-web-1  |       -                                 # -1 allows indefinite delay
gitlab-web-1  |       -#wal_receiver_status_interval = 10s      # send replies at least this often
gitlab-web-1  |       -                                 # 0 disables
gitlab-web-1  |       -#hot_standby_feedback = off              # send info from standby to prevent
gitlab-web-1  |       -                                 # query conflicts
gitlab-web-1  |       -#wal_receiver_timeout = 60s              # time that receiver waits for
gitlab-web-1  |       -                                 # communication from master
gitlab-web-1  |       -                                 # in milliseconds; 0 disables
gitlab-web-1  |       -#wal_retrieve_retry_interval = 5s        # time to wait before retrying to
gitlab-web-1  |       -                                 # retrieve WAL after a failed attempt
gitlab-web-1  |       -#recovery_min_apply_delay = 0            # minimum delay for applying changes during recovery
gitlab-web-1  |       +hot_standby = off
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |       +#wal_receiver_status_interval = 10s # send replies at least this often
gitlab-web-1  |       +          # 0 disables
gitlab-web-1  |
gitlab-web-1  |       -# - Subscribers -
gitlab-web-1  |       -
gitlab-web-1  |       -# These settings are ignored on a publisher.
gitlab-web-1  |       -
gitlab-web-1  |       -#max_logical_replication_workers = 4     # taken from max_worker_processes
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#max_sync_workers_per_subscription = 2   # taken from max_logical_replication_workers
gitlab-web-1  |       -
gitlab-web-1  |       -
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |        # QUERY TUNING
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |       @@ -350,218 +228,126 @@
gitlab-web-1  |        #enable_hashagg = on
gitlab-web-1  |        #enable_hashjoin = on
gitlab-web-1  |        #enable_indexscan = on
gitlab-web-1  |       -#enable_indexonlyscan = on
gitlab-web-1  |        #enable_material = on
gitlab-web-1  |        #enable_mergejoin = on
gitlab-web-1  |        #enable_nestloop = on
gitlab-web-1  |       -#enable_parallel_append = on
gitlab-web-1  |        #enable_seqscan = on
gitlab-web-1  |        #enable_sort = on
gitlab-web-1  |        #enable_tidscan = on
gitlab-web-1  |       -#enable_partitionwise_join = off
gitlab-web-1  |       -#enable_partitionwise_aggregate = off
gitlab-web-1  |       -#enable_parallel_hash = on
gitlab-web-1  |       -#enable_partition_pruning = on
gitlab-web-1  |
gitlab-web-1  |        # - Planner Cost Constants -
gitlab-web-1  |
gitlab-web-1  |       -#seq_page_cost = 1.0                     # measured on an arbitrary scale
gitlab-web-1  |       -#random_page_cost = 4.0                  # same scale as above
gitlab-web-1  |       -#cpu_tuple_cost = 0.01                   # same scale as above
gitlab-web-1  |       -#cpu_index_tuple_cost = 0.005            # same scale as above
gitlab-web-1  |       -#cpu_operator_cost = 0.0025              # same scale as above
gitlab-web-1  |       -#parallel_tuple_cost = 0.1               # same scale as above
gitlab-web-1  |       -#parallel_setup_cost = 1000.0    # same scale as above
gitlab-web-1  |       +#cpu_tuple_cost = 0.01      # same scale as above
gitlab-web-1  |       +#cpu_index_tuple_cost = 0.005   # same scale as above
gitlab-web-1  |       +#cpu_operator_cost = 0.0025   # same scale as above
gitlab-web-1  |
gitlab-web-1  |       -#jit_above_cost = 100000         # perform JIT compilation if available
gitlab-web-1  |       -                                 # and query more expensive than this;
gitlab-web-1  |       -                                 # -1 disables
gitlab-web-1  |       -#jit_inline_above_cost = 500000          # inline small functions if query is
gitlab-web-1  |       -                                 # more expensive than this; -1 disables
gitlab-web-1  |       -#jit_optimize_above_cost = 500000        # use expensive JIT optimizations if
gitlab-web-1  |       -                                 # query is more expensive than this;
gitlab-web-1  |       -                                 # -1 disables
gitlab-web-1  |       -
gitlab-web-1  |       -#min_parallel_table_scan_size = 8MB
gitlab-web-1  |       -#min_parallel_index_scan_size = 512kB
gitlab-web-1  |       -#effective_cache_size = 4GB
gitlab-web-1  |       -
gitlab-web-1  |        # - Genetic Query Optimizer -
gitlab-web-1  |
gitlab-web-1  |        #geqo = on
gitlab-web-1  |        #geqo_threshold = 12
gitlab-web-1  |       -#geqo_effort = 5                 # range 1-10
gitlab-web-1  |       -#geqo_pool_size = 0                      # selects default based on effort
gitlab-web-1  |       -#geqo_generations = 0                    # selects default based on effort
gitlab-web-1  |       -#geqo_selection_bias = 2.0               # range 1.5-2.0
gitlab-web-1  |       -#geqo_seed = 0.0                 # range 0.0-1.0
gitlab-web-1  |       +#geqo_effort = 5      # range 1-10
gitlab-web-1  |       +#geqo_pool_size = 0     # selects default based on effort
gitlab-web-1  |       +#geqo_generations = 0     # selects default based on effort
gitlab-web-1  |       +#geqo_selection_bias = 2.0    # range 1.5-2.0
gitlab-web-1  |       +#geqo_seed = 0.0      # range 0.0-1.0
gitlab-web-1  |
gitlab-web-1  |        # - Other Planner Options -
gitlab-web-1  |
gitlab-web-1  |       -#default_statistics_target = 100 # range 1-10000
gitlab-web-1  |       -#constraint_exclusion = partition        # on, off, or partition
gitlab-web-1  |       -#cursor_tuple_fraction = 0.1             # range 0.0-1.0
gitlab-web-1  |       +#default_statistics_target = 100  # range 1-10000
gitlab-web-1  |       +#constraint_exclusion = partition # on, off, or partition
gitlab-web-1  |       +#cursor_tuple_fraction = 0.1    # range 0.0-1.0
gitlab-web-1  |        #from_collapse_limit = 8
gitlab-web-1  |       -#join_collapse_limit = 8         # 1 disables collapsing of explicit
gitlab-web-1  |       -                                 # JOIN clauses
gitlab-web-1  |       -#force_parallel_mode = off
gitlab-web-1  |       -#jit = on                                # allow JIT compilation
gitlab-web-1  |       -#plan_cache_mode = auto                  # auto, force_generic_plan or
gitlab-web-1  |       -                                 # force_custom_plan
gitlab-web-1  |       +#join_collapse_limit = 8    # 1 disables collapsing of explicit
gitlab-web-1  |       +          # JOIN clauses
gitlab-web-1  |
gitlab-web-1  |
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |       -# REPORTING AND LOGGING
gitlab-web-1  |       +# ERROR REPORTING AND LOGGING
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |
gitlab-web-1  |       -# - Where to Log -
gitlab-web-1  |
gitlab-web-1  |       -#log_destination = 'stderr'              # Valid values are combinations of
gitlab-web-1  |       -                                 # stderr, csvlog, syslog, and eventlog,
gitlab-web-1  |       -                                 # depending on platform.  csvlog
gitlab-web-1  |       -                                 # requires logging_collector to be on.
gitlab-web-1  |       -
gitlab-web-1  |       -# This is used when logging to stderr:
gitlab-web-1  |       -#logging_collector = off         # Enable capturing of stderr and csvlog
gitlab-web-1  |       -                                 # into log files. Required to be on for
gitlab-web-1  |       -                                 # csvlogs.
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -
gitlab-web-1  |       -# These are only used if logging_collector is on:
gitlab-web-1  |       -#log_directory = 'log'                   # directory where log files are written,
gitlab-web-1  |       -                                 # can be absolute or relative to PGDATA
gitlab-web-1  |       -#log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log' # log file name pattern,
gitlab-web-1  |       -                                 # can include strftime() escapes
gitlab-web-1  |       -#log_file_mode = 0600                    # creation mode for log files,
gitlab-web-1  |       -                                 # begin with 0 to use octal notation
gitlab-web-1  |       -#log_truncate_on_rotation = off          # If on, an existing log file with the
gitlab-web-1  |       -                                 # same name as the new log file will be
gitlab-web-1  |       -                                 # truncated rather than appended to.
gitlab-web-1  |       -                                 # But such truncation only occurs on
gitlab-web-1  |       -                                 # time-driven rotation, not on restarts
gitlab-web-1  |       -                                 # or size-driven rotation.  Default is
gitlab-web-1  |       -                                 # off, meaning append to existing files
gitlab-web-1  |       -                                 # in all cases.
gitlab-web-1  |       -#log_rotation_age = 1d                   # Automatic rotation of logfiles will
gitlab-web-1  |       -                                 # happen after that time.  0 disables.
gitlab-web-1  |       -#log_rotation_size = 10MB                # Automatic rotation of logfiles will
gitlab-web-1  |       -                                 # happen after that much log output.
gitlab-web-1  |       -                                 # 0 disables.
gitlab-web-1  |       -
gitlab-web-1  |        # These are relevant when logging to syslog:
gitlab-web-1  |        #syslog_facility = 'LOCAL0'
gitlab-web-1  |        #syslog_ident = 'postgres'
gitlab-web-1  |       -#syslog_sequence_numbers = on
gitlab-web-1  |       -#syslog_split_messages = on
gitlab-web-1  |
gitlab-web-1  |       -# This is only relevant when logging to eventlog (win32):
gitlab-web-1  |       -# (change requires restart)
gitlab-web-1  |       -#event_source = 'PostgreSQL'
gitlab-web-1  |       +#silent_mode = off      # Run server silently.
gitlab-web-1  |       +          # DO NOT USE without syslog or
gitlab-web-1  |       +          # logging_collector
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |
gitlab-web-1  |       +
gitlab-web-1  |        # - When to Log -
gitlab-web-1  |
gitlab-web-1  |       -#log_min_messages = warning              # values in order of decreasing detail:
gitlab-web-1  |       -                                 #   debug5
gitlab-web-1  |       -                                 #   debug4
gitlab-web-1  |       -                                 #   debug3
gitlab-web-1  |       -                                 #   debug2
gitlab-web-1  |       -                                 #   debug1
gitlab-web-1  |       -                                 #   info
gitlab-web-1  |       -                                 #   notice
gitlab-web-1  |       -                                 #   warning
gitlab-web-1  |       -                                 #   error
gitlab-web-1  |       -                                 #   log
gitlab-web-1  |       -                                 #   fatal
gitlab-web-1  |       -                                 #   panic
gitlab-web-1  |       +#client_min_messages = notice   # values in order of decreasing detail:
gitlab-web-1  |       +          #   debug5
gitlab-web-1  |       +          #   debug4
gitlab-web-1  |       +          #   debug3
gitlab-web-1  |       +          #   debug2
gitlab-web-1  |       +          #   debug1
gitlab-web-1  |       +          #   log
gitlab-web-1  |       +          #   notice
gitlab-web-1  |       +          #   warning
gitlab-web-1  |       +          #   error
gitlab-web-1  |
gitlab-web-1  |       -#log_min_error_statement = error # values in order of decreasing detail:
gitlab-web-1  |       -                                 #   debug5
gitlab-web-1  |       -                                 #   debug4
gitlab-web-1  |       -                                 #   debug3
gitlab-web-1  |       -                                 #   debug2
gitlab-web-1  |       -                                 #   debug1
gitlab-web-1  |       -                                 #   info
gitlab-web-1  |       -                                 #   notice
gitlab-web-1  |       -                                 #   warning
gitlab-web-1  |       -                                 #   error
gitlab-web-1  |       -                                 #   log
gitlab-web-1  |       -                                 #   fatal
gitlab-web-1  |       -                                 #   panic (effectively off)
gitlab-web-1  |       +#log_min_messages = warning   # values in order of decreasing detail:
gitlab-web-1  |       +          #   debug5
gitlab-web-1  |       +          #   debug4
gitlab-web-1  |       +          #   debug3
gitlab-web-1  |       +          #   debug2
gitlab-web-1  |       +          #   debug1
gitlab-web-1  |       +          #   info
gitlab-web-1  |       +          #   notice
gitlab-web-1  |       +          #   warning
gitlab-web-1  |       +          #   error
gitlab-web-1  |       +          #   log
gitlab-web-1  |       +          #   fatal
gitlab-web-1  |       +          #   panic
gitlab-web-1  |
gitlab-web-1  |       -#log_min_duration_statement = -1 # -1 is disabled, 0 logs all statements
gitlab-web-1  |       -                                 # and their durations, > 0 logs only
gitlab-web-1  |       -                                 # statements running at least this number
gitlab-web-1  |       -                                 # of milliseconds
gitlab-web-1  |       +#log_min_error_statement = error  # values in order of decreasing detail:
gitlab-web-1  |       +          #   debug5
gitlab-web-1  |       +          #   debug4
gitlab-web-1  |       +          #   debug3
gitlab-web-1  |       +          #   debug2
gitlab-web-1  |       +          #   debug1
gitlab-web-1  |       +          #   info
gitlab-web-1  |       +          #   notice
gitlab-web-1  |       +          #   warning
gitlab-web-1  |       +          #   error
gitlab-web-1  |       +          #   log
gitlab-web-1  |       +          #   fatal
gitlab-web-1  |       +          #   panic (effectively off)
gitlab-web-1  |
gitlab-web-1  |       -#log_transaction_sample_rate = 0.0       # Fraction of transactions whose statements
gitlab-web-1  |       -                                 # are logged regardless of their duration. 1.0 logs all
gitlab-web-1  |       -                                 # statements from all transactions, 0.0 never logs.
gitlab-web-1  |       -
gitlab-web-1  |        # - What to Log -
gitlab-web-1  |
gitlab-web-1  |        #debug_print_parse = off
gitlab-web-1  |        #debug_print_rewritten = off
gitlab-web-1  |        #debug_print_plan = off
gitlab-web-1  |        #debug_pretty_print = on
gitlab-web-1  |       -#log_checkpoints = off
gitlab-web-1  |        #log_connections = off
gitlab-web-1  |        #log_disconnections = off
gitlab-web-1  |        #log_duration = off
gitlab-web-1  |       -#log_error_verbosity = default           # terse, default, or verbose messages
gitlab-web-1  |       +#log_error_verbosity = default    # terse, default, or verbose messages
gitlab-web-1  |        #log_hostname = off
gitlab-web-1  |       -#log_line_prefix = '%m [%p] '            # special values:
gitlab-web-1  |       -                                 #   %a = application name
gitlab-web-1  |       -                                 #   %u = user name
gitlab-web-1  |       -                                 #   %d = database name
gitlab-web-1  |       -                                 #   %r = remote host and port
gitlab-web-1  |       -                                 #   %h = remote host
gitlab-web-1  |       -                                 #   %p = process ID
gitlab-web-1  |       -                                 #   %t = timestamp without milliseconds
gitlab-web-1  |       -                                 #   %m = timestamp with milliseconds
gitlab-web-1  |       -                                 #   %n = timestamp with milliseconds (as a Unix epoch)
gitlab-web-1  |       -                                 #   %i = command tag
gitlab-web-1  |       -                                 #   %e = SQL state
gitlab-web-1  |       -                                 #   %c = session ID
gitlab-web-1  |       -                                 #   %l = session line number
gitlab-web-1  |       -                                 #   %s = session start timestamp
gitlab-web-1  |       -                                 #   %v = virtual transaction ID
gitlab-web-1  |       -                                 #   %x = transaction ID (0 if none)
gitlab-web-1  |       -                                 #   %q = stop here in non-session
gitlab-web-1  |       -                                 #        processes
gitlab-web-1  |       -                                 #   %% = '%'
gitlab-web-1  |       -                                 # e.g. '<%u%%%d> '
gitlab-web-1  |       -#log_lock_waits = off                    # log lock waits >= deadlock_timeout
gitlab-web-1  |       -#log_statement = 'none'                  # none, ddl, mod, all
gitlab-web-1  |       -#log_replication_commands = off
gitlab-web-1  |       -#log_temp_files = -1                     # log temporary files equal or larger
gitlab-web-1  |       -                                 # than the specified size in kilobytes;
gitlab-web-1  |       -                                 # -1 disables, 0 logs all temp files
gitlab-web-1  |       -log_timezone = 'Etc/UTC'
gitlab-web-1  |       +#log_lock_waits = off     # log lock waits >= deadlock_timeout
gitlab-web-1  |       +#log_statement = 'none'     # none, ddl, mod, all
gitlab-web-1  |       +#log_timezone = '(defaults to server environment setting)'
gitlab-web-1  |
gitlab-web-1  |       -#------------------------------------------------------------------------------
gitlab-web-1  |       -# PROCESS TITLE
gitlab-web-1  |       -#------------------------------------------------------------------------------
gitlab-web-1  |
gitlab-web-1  |       -#cluster_name = ''                       # added to process titles if nonempty
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#update_process_title = on
gitlab-web-1  |       -
gitlab-web-1  |       -
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |       -# STATISTICS
gitlab-web-1  |       +# RUNTIME STATISTICS
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |
gitlab-web-1  |       -# - Query and Index Statistics Collector -
gitlab-web-1  |       +# - Query/Index Statistics Collector -
gitlab-web-1  |
gitlab-web-1  |        #track_activities = on
gitlab-web-1  |        #track_counts = on
gitlab-web-1  |       -#track_io_timing = off
gitlab-web-1  |       -#track_functions = none                  # none, pl, all
gitlab-web-1  |       -#track_activity_query_size = 1024        # (change requires restart)
gitlab-web-1  |       +#track_functions = none     # none, pl, all
gitlab-web-1  |       +track_activity_query_size = 1024 # (change requires restart)
gitlab-web-1  |       +#update_process_title = on
gitlab-web-1  |        #stats_temp_directory = 'pg_stat_tmp'
gitlab-web-1  |
gitlab-web-1  |
gitlab-web-1  |       -# - Monitoring -
gitlab-web-1  |       +# - Statistics Monitoring -
gitlab-web-1  |
gitlab-web-1  |        #log_parser_stats = off
gitlab-web-1  |        #log_planner_stats = off
gitlab-web-1  |       @@ -570,117 +356,53 @@
gitlab-web-1  |
gitlab-web-1  |
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |       -# AUTOVACUUM
gitlab-web-1  |       +# AUTOVACUUM PARAMETERS
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |
gitlab-web-1  |       -#autovacuum = on                 # Enable autovacuum subprocess?  'on'
gitlab-web-1  |       -                                 # requires track_counts to also be on.
gitlab-web-1  |       -#log_autovacuum_min_duration = -1        # -1 disables, 0 logs all actions and
gitlab-web-1  |       -                                 # their durations, > 0 logs only
gitlab-web-1  |       -                                 # actions running at least this number
gitlab-web-1  |       -                                 # of milliseconds.
gitlab-web-1  |       -#autovacuum_max_workers = 3              # max number of autovacuum subprocesses
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#autovacuum_naptime = 1min               # time between autovacuum runs
gitlab-web-1  |       -#autovacuum_vacuum_threshold = 50        # min number of row updates before
gitlab-web-1  |       -                                 # vacuum
gitlab-web-1  |       -#autovacuum_analyze_threshold = 50       # min number of row updates before
gitlab-web-1  |       -                                 # analyze
gitlab-web-1  |       -#autovacuum_vacuum_scale_factor = 0.2    # fraction of table size before vacuum
gitlab-web-1  |       -#autovacuum_analyze_scale_factor = 0.1   # fraction of table size before analyze
gitlab-web-1  |       -#autovacuum_freeze_max_age = 200000000   # maximum XID age before forced vacuum
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#autovacuum_multixact_freeze_max_age = 400000000 # maximum multixact age
gitlab-web-1  |       -                                 # before forced vacuum
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#autovacuum_vacuum_cost_delay = 2ms      # default vacuum cost delay for
gitlab-web-1  |       -                                 # autovacuum, in milliseconds;
gitlab-web-1  |       -                                 # -1 means use vacuum_cost_delay
gitlab-web-1  |       -#autovacuum_vacuum_cost_limit = -1       # default vacuum cost limit for
gitlab-web-1  |       -                                 # autovacuum, -1 means use
gitlab-web-1  |       -                                 # vacuum_cost_limit
gitlab-web-1  |       -
gitlab-web-1  |       -
gitlab-web-1  |       +autovacuum_max_workers = 3 # max number of autovacuum subprocesses
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |       +autovacuum_freeze_max_age = 200000000  # maximum XID age before forced vacuum
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |        # CLIENT CONNECTION DEFAULTS
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |
gitlab-web-1  |        # - Statement Behavior -
gitlab-web-1  |
gitlab-web-1  |       -#client_min_messages = notice            # values in order of decreasing detail:
gitlab-web-1  |       -                                 #   debug5
gitlab-web-1  |       -                                 #   debug4
gitlab-web-1  |       -                                 #   debug3
gitlab-web-1  |       -                                 #   debug2
gitlab-web-1  |       -                                 #   debug1
gitlab-web-1  |       -                                 #   log
gitlab-web-1  |       -                                 #   notice
gitlab-web-1  |       -                                 #   warning
gitlab-web-1  |       -                                 #   error
gitlab-web-1  |       -#search_path = '"$user", public' # schema names
gitlab-web-1  |       -#row_security = on
gitlab-web-1  |       -#default_tablespace = ''         # a tablespace name, '' uses the default
gitlab-web-1  |       -#temp_tablespaces = ''                   # a list of tablespace names, '' uses
gitlab-web-1  |       -                                 # only default tablespace
gitlab-web-1  |       -#default_table_access_method = 'heap'
gitlab-web-1  |       +#search_path = '"$user",public'   # schema names
gitlab-web-1  |       +#default_tablespace = ''    # a tablespace name, '' uses the default
gitlab-web-1  |       +#temp_tablespaces = ''      # a list of tablespace names, '' uses
gitlab-web-1  |       +          # only default tablespace
gitlab-web-1  |        #check_function_bodies = on
gitlab-web-1  |        #default_transaction_isolation = 'read committed'
gitlab-web-1  |        #default_transaction_read_only = off
gitlab-web-1  |        #default_transaction_deferrable = off
gitlab-web-1  |        #session_replication_role = 'origin'
gitlab-web-1  |       -#statement_timeout = 0                   # in milliseconds, 0 is disabled
gitlab-web-1  |       -#lock_timeout = 0                        # in milliseconds, 0 is disabled
gitlab-web-1  |       -#idle_in_transaction_session_timeout = 0 # in milliseconds, 0 is disabled
gitlab-web-1  |        #vacuum_freeze_min_age = 50000000
gitlab-web-1  |        #vacuum_freeze_table_age = 150000000
gitlab-web-1  |       -#vacuum_multixact_freeze_min_age = 5000000
gitlab-web-1  |       -#vacuum_multixact_freeze_table_age = 150000000
gitlab-web-1  |       -#vacuum_cleanup_index_scale_factor = 0.1 # fraction of total number of tuples
gitlab-web-1  |       -                                         # before index cleanup, 0 always performs
gitlab-web-1  |       -                                         # index cleanup
gitlab-web-1  |       -#bytea_output = 'hex'                    # hex, escape
gitlab-web-1  |       +#bytea_output = 'hex'     # hex, escape
gitlab-web-1  |        #xmlbinary = 'base64'
gitlab-web-1  |        #xmloption = 'content'
gitlab-web-1  |       -#gin_fuzzy_search_limit = 0
gitlab-web-1  |       -#gin_pending_list_limit = 4MB
gitlab-web-1  |
gitlab-web-1  |        # - Locale and Formatting -
gitlab-web-1  |
gitlab-web-1  |       -datestyle = 'iso, mdy'
gitlab-web-1  |        #intervalstyle = 'postgres'
gitlab-web-1  |       -timezone = 'Etc/UTC'
gitlab-web-1  |       +#timezone = '(defaults to server environment setting)'
gitlab-web-1  |        #timezone_abbreviations = 'Default'     # Select the set of available time zone
gitlab-web-1  |       -                                 # abbreviations.  Currently, there are
gitlab-web-1  |       -                                 #   Default
gitlab-web-1  |       -                                 #   Australia (historical usage)
gitlab-web-1  |       -                                 #   India
gitlab-web-1  |       -                                 # You can create your own file in
gitlab-web-1  |       -                                 # share/timezonesets/.
gitlab-web-1  |       -#extra_float_digits = 1                  # min -15, max 3; any value >0 actually
gitlab-web-1  |       -                                 # selects precise output mode
gitlab-web-1  |       -#client_encoding = sql_ascii             # actually, defaults to database
gitlab-web-1  |       -                                 # encoding
gitlab-web-1  |       +          # abbreviations.  Currently, there are
gitlab-web-1  |       +          #   Default
gitlab-web-1  |       +          #   Australia
gitlab-web-1  |       +          #   India
gitlab-web-1  |       +          # You can create your own file in
gitlab-web-1  |       +          # share/timezonesets/.
gitlab-web-1  |       +#extra_float_digits = 0     # min -15, max 3
gitlab-web-1  |       +#client_encoding = sql_ascii    # actually, defaults to database
gitlab-web-1  |       +          # encoding
gitlab-web-1  |
gitlab-web-1  |       -# These settings are initialized by initdb, but they can be changed.
gitlab-web-1  |       -lc_messages = 'C.UTF-8'                  # locale for system error message
gitlab-web-1  |       -                                 # strings
gitlab-web-1  |       -lc_monetary = 'C.UTF-8'                  # locale for monetary formatting
gitlab-web-1  |       -lc_numeric = 'C.UTF-8'                   # locale for number formatting
gitlab-web-1  |       -lc_time = 'C.UTF-8'                              # locale for time formatting
gitlab-web-1  |       -
gitlab-web-1  |       -# default configuration for text search
gitlab-web-1  |       -default_text_search_config = 'pg_catalog.english'
gitlab-web-1  |       -
gitlab-web-1  |       -# - Shared Library Preloading -
gitlab-web-1  |       -
gitlab-web-1  |       -#shared_preload_libraries = ''   # (change requires restart)
gitlab-web-1  |       -#local_preload_libraries = ''
gitlab-web-1  |       -#session_preload_libraries = ''
gitlab-web-1  |       -#jit_provider = 'llvmjit'                # JIT library to use
gitlab-web-1  |       -
gitlab-web-1  |        # - Other Defaults -
gitlab-web-1  |
gitlab-web-1  |        #dynamic_library_path = '$libdir'
gitlab-web-1  |       +#local_preload_libraries = ''
gitlab-web-1  |
gitlab-web-1  |
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |       @@ -688,28 +410,27 @@
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |
gitlab-web-1  |        #deadlock_timeout = 1s
gitlab-web-1  |       -#max_locks_per_transaction = 64          # min 10
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#max_pred_locks_per_transaction = 64     # min 10
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       -#max_pred_locks_per_relation = -2        # negative values mean
gitlab-web-1  |       -                                 # (max_pred_locks_per_transaction
gitlab-web-1  |       -                                 #  / -max_pred_locks_per_relation) - 1
gitlab-web-1  |       -#max_pred_locks_per_page = 2            # min 0
gitlab-web-1  |       +max_locks_per_transaction = 128   # min 10
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |       +# Note:  Each lock table slot uses ~270 bytes of shared memory, and there are
gitlab-web-1  |       +# max_locks_per_transaction * (max_connections + max_prepared_transactions)
gitlab-web-1  |       +# lock table slots.
gitlab-web-1  |       +#max_pred_locks_per_transaction = 64  # min 10
gitlab-web-1  |       +          # (change requires restart)
gitlab-web-1  |
gitlab-web-1  |       -
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |       -# VERSION AND PLATFORM COMPATIBILITY
gitlab-web-1  |       +# VERSION/PLATFORM COMPATIBILITY
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |
gitlab-web-1  |        # - Previous PostgreSQL Versions -
gitlab-web-1  |
gitlab-web-1  |        #array_nulls = on
gitlab-web-1  |       -#backslash_quote = safe_encoding # on, off, or safe_encoding
gitlab-web-1  |       +#backslash_quote = safe_encoding  # on, off, or safe_encoding
gitlab-web-1  |       +#default_with_oids = off
gitlab-web-1  |        #escape_string_warning = on
gitlab-web-1  |        #lo_compat_privileges = off
gitlab-web-1  |       -#operator_precedence_warning = off
gitlab-web-1  |        #quote_all_identifiers = off
gitlab-web-1  |       +#sql_inheritance = on
gitlab-web-1  |        #standard_conforming_strings = on
gitlab-web-1  |        #synchronize_seqscans = on
gitlab-web-1  |
gitlab-web-1  |       @@ -722,30 +443,15 @@
gitlab-web-1  |        # ERROR HANDLING
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |
gitlab-web-1  |       -#exit_on_error = off                     # terminate session on any error?
gitlab-web-1  |       -#restart_after_crash = on                # reinitialize after backend crash?
gitlab-web-1  |       -#data_sync_retry = off                   # retry or panic on failure to fsync
gitlab-web-1  |       -                                 # data?
gitlab-web-1  |       -                                 # (change requires restart)
gitlab-web-1  |       +#exit_on_error = off        # terminate session on any error?
gitlab-web-1  |       +#restart_after_crash = on     # reinitialize after backend crash?
gitlab-web-1  |
gitlab-web-1  |
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |       -# CONFIG FILE INCLUDES
gitlab-web-1  |       -#------------------------------------------------------------------------------
gitlab-web-1  |       -
gitlab-web-1  |       -# These options allow settings to be loaded from files other than the
gitlab-web-1  |       -# default postgresql.conf.  Note that these are directives, not variable
gitlab-web-1  |       -# assignments, so they can usefully be given more than once.
gitlab-web-1  |       -
gitlab-web-1  |       -#include_dir = '...'                     # include files ending in '.conf' from
gitlab-web-1  |       -                                 # a directory, e.g., 'conf.d'
gitlab-web-1  |       -#include_if_exists = '...'               # include file only if it exists
gitlab-web-1  |       -#include = '...'                 # include file
gitlab-web-1  |       -
gitlab-web-1  |       -
gitlab-web-1  |       -#------------------------------------------------------------------------------
gitlab-web-1  |        # CUSTOMIZED OPTIONS
gitlab-web-1  |        #------------------------------------------------------------------------------
gitlab-web-1  |
gitlab-web-1  |       -# Add settings for extensions here
gitlab-web-1  |       +#custom_variable_classes = ''   # list of custom variable class names
gitlab-web-1  |       +
gitlab-web-1  |       +include 'runtime.conf'
gitlab-web-1  |       - change mode from '0600' to '0644'
gitlab-web-1  |     * template[/var/opt/gitlab/postgresql/data/runtime.conf] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/postgresql/data/runtime.conf
gitlab-web-1  |       - update content in file /var/opt/gitlab/postgresql/data/runtime.conf from none to 38c1f9
gitlab-web-1  |       --- /var/opt/gitlab/postgresql/data/runtime.conf  2022-07-28 06:56:55.689452510 +0000
gitlab-web-1  |       +++ /var/opt/gitlab/postgresql/data/.chef-runtime20220728-35-sv2h3.conf   2022-07-28 06:56:55.689452510 +0000
gitlab-web-1  |       @@ -1 +1,135 @@
gitlab-web-1  |       +# This file is managed by gitlab-ctl. Manual changes will be
gitlab-web-1  |       +# erased! To change the contents below, edit /etc/gitlab/gitlab.rb
gitlab-web-1  |       +# and run `sudo gitlab-ctl reconfigure`.
gitlab-web-1  |       +
gitlab-web-1  |       +# Changing variables in this file should only require a reload of PostgreSQL
gitlab-web-1  |       +# As the gitlab-psql user, run:
gitlab-web-1  |       +# /opt/gitlab/embedded/bin/pg_ctl reload -D /var/opt/gitlab/postgresql/data
gitlab-web-1  |       +work_mem = 16MB                          # min 64kB
gitlab-web-1  |       +maintenance_work_mem = 16MB # 16MB    # min 1MB
gitlab-web-1  |       +synchronous_commit = on # synchronization level; on, off, or local
gitlab-web-1  |       +synchronous_standby_names = ''
gitlab-web-1  |       +
gitlab-web-1  |       +# - Checkpoints -
gitlab-web-1  |       +min_wal_size = 80MB
gitlab-web-1  |       +max_wal_size = 1GB
gitlab-web-1  |       +
gitlab-web-1  |       +checkpoint_timeout = 5min                # range 30s-1h, default 5min
gitlab-web-1  |       +checkpoint_completion_target = 0.9       # checkpoint target duration, 0.0 - 1.0, default 0.5
gitlab-web-1  |       +checkpoint_warning = 30s         # 0 disables, default 30s
gitlab-web-1  |       +
gitlab-web-1  |       +# - Logging -
gitlab-web-1  |       +log_directory = '/var/log/gitlab/postgresql'
gitlab-web-1  |       +
gitlab-web-1  |       +# - Archiving -
gitlab-web-1  |       +archive_command = ''   # command to use to archive a logfile segment
gitlab-web-1  |       +archive_timeout = 0    # force a logfile segment switch after this
gitlab-web-1  |       +        # number of seconds; 0 disables
gitlab-web-1  |       +
gitlab-web-1  |       +# - Replication
gitlab-web-1  |       +wal_keep_segments = 10
gitlab-web-1  |       +
gitlab-web-1  |       +max_standby_archive_delay = 30s # max delay before canceling queries
gitlab-web-1  |       +          # when reading WAL from archive;
gitlab-web-1  |       +          # -1 allows indefinite delay
gitlab-web-1  |       +max_standby_streaming_delay = 30s # max delay before canceling queries
gitlab-web-1  |       +          # when reading streaming WAL;
gitlab-web-1  |       +          # -1 allows indefinite delay
gitlab-web-1  |       +
gitlab-web-1  |       +hot_standby_feedback = off   # send info from standby to prevent
gitlab-web-1  |       +          # query conflicts
gitlab-web-1  |       +
gitlab-web-1  |       +# - Planner Cost Constants -
gitlab-web-1  |       +#seq_page_cost = 1.0      # measured on an arbitrary scale
gitlab-web-1  |       +random_page_cost = 2.0     # same scale as above
gitlab-web-1  |       +
gitlab-web-1  |       +effective_cache_size = 1496MB # Default 128MB
gitlab-web-1  |       +
gitlab-web-1  |       +log_min_duration_statement = -1  # -1 is disabled, 0 logs all statements
gitlab-web-1  |       +          # and their durations, > 0 logs only
gitlab-web-1  |       +          # statements running at least this number
gitlab-web-1  |       +          # of milliseconds
gitlab-web-1  |       +
gitlab-web-1  |       +log_checkpoints = off
gitlab-web-1  |       +
gitlab-web-1  |       +log_line_prefix = '' # default '', special values:
gitlab-web-1  |       +          #   %a = application name
gitlab-web-1  |       +          #   %u = user name
gitlab-web-1  |       +          #   %d = database name
gitlab-web-1  |       +          #   %r = remote host and port
gitlab-web-1  |       +          #   %h = remote host
gitlab-web-1  |       +          #   %p = process ID
gitlab-web-1  |       +          #   %t = timestamp without milliseconds
gitlab-web-1  |       +          #   %m = timestamp with milliseconds
gitlab-web-1  |       +          #   %i = command tag
gitlab-web-1  |       +          #   %e = SQL state
gitlab-web-1  |       +          #   %c = session ID
gitlab-web-1  |       +          #   %l = session line number
gitlab-web-1  |       +          #   %s = session start timestamp
gitlab-web-1  |       +          #   %v = virtual transaction ID
gitlab-web-1  |       +          #   %x = transaction ID (0 if none)
gitlab-web-1  |       +          #   %q = stop here in non-session
gitlab-web-1  |       +          #        processes
gitlab-web-1  |       +          #   %% = '%'
gitlab-web-1  |       +
gitlab-web-1  |       +log_temp_files = -1      # log temporary files equal or larger
gitlab-web-1  |       +          # than the specified size in kilobytes;
gitlab-web-1  |       +          # -1 disables, 0 logs all temp files
gitlab-web-1  |       +
gitlab-web-1  |       +
gitlab-web-1  |       +# - Autovacuum parameters -
gitlab-web-1  |       +autovacuum = on # Enable autovacuum subprocess?  'on'
gitlab-web-1  |       +          # requires track_counts to also be on.
gitlab-web-1  |       +
gitlab-web-1  |       +log_autovacuum_min_duration = -1 # -1 disables, 0 logs all actions and
gitlab-web-1  |       +          # their durations, > 0 logs only
gitlab-web-1  |       +          # actions running at least this number
gitlab-web-1  |       +          # of milliseconds.
gitlab-web-1  |       +
gitlab-web-1  |       +autovacuum_naptime = 1min # time between autovacuum runs
gitlab-web-1  |       +autovacuum_vacuum_threshold = 50 # min number of row updates before
gitlab-web-1  |       +          # vacuum
gitlab-web-1  |       +autovacuum_analyze_threshold = 50 # min number of row updates before
gitlab-web-1  |       +          # analyze
gitlab-web-1  |       +autovacuum_vacuum_scale_factor = 0.02 # fraction of table size before vacuum
gitlab-web-1  |       +autovacuum_analyze_scale_factor = 0.01 # fraction of table size before analyze
gitlab-web-1  |       +autovacuum_vacuum_cost_delay = 20ms # default vacuum cost delay for
gitlab-web-1  |       +          # autovacuum, in milliseconds;
gitlab-web-1  |       +          # -1 means use vacuum_cost_delay
gitlab-web-1  |       +autovacuum_vacuum_cost_limit = -1 # default vacuum cost limit for
gitlab-web-1  |       +          # autovacuum, -1 means use
gitlab-web-1  |       +          # vacuum_cost_limit
gitlab-web-1  |       +
gitlab-web-1  |       +# Parameters for gathering statistics
gitlab-web-1  |       +default_statistics_target = 1000
gitlab-web-1  |       +
gitlab-web-1  |       +# - Client connection timeouts
gitlab-web-1  |       +statement_timeout = 60000
gitlab-web-1  |       +
gitlab-web-1  |       +idle_in_transaction_session_timeout = 60000
gitlab-web-1  |       +
gitlab-web-1  |       +# IO settings
gitlab-web-1  |       +effective_io_concurrency = 1
gitlab-web-1  |       +track_io_timing = 'off'
gitlab-web-1  |       +
gitlab-web-1  |       +# Parallel worker settings
gitlab-web-1  |       +max_worker_processes = 8
gitlab-web-1  |       +max_parallel_workers_per_gather = 0
gitlab-web-1  |       +
gitlab-web-1  |       +# Deadlock handling and logging
gitlab-web-1  |       +deadlock_timeout = '5s'
gitlab-web-1  |       +log_lock_waits = 1
gitlab-web-1  |       +
gitlab-web-1  |       +# - Locale and Formatting -
gitlab-web-1  |       +datestyle = 'iso, mdy'
gitlab-web-1  |       +
gitlab-web-1  |       +# These settings are initialized by initdb, but they can be changed.
gitlab-web-1  |       +lc_messages = 'C'     # locale for system error message
gitlab-web-1  |       +          # strings
gitlab-web-1  |       +lc_monetary = 'C'     # locale for monetary formatting
gitlab-web-1  |       +lc_numeric = 'C'      # locale for number formatting
gitlab-web-1  |       +lc_time = 'C'       # locale for time formatting
gitlab-web-1  |       +
gitlab-web-1  |       +# default configuration for text search
gitlab-web-1  |       +default_text_search_config = 'pg_catalog.english'
gitlab-web-1  |       - change mode from '' to '0644'
gitlab-web-1  |       - change owner from '' to 'gitlab-psql'
gitlab-web-1  |     * template[/var/opt/gitlab/postgresql/data/pg_hba.conf] action create
gitlab-web-1  |       - update content in file /var/opt/gitlab/postgresql/data/pg_hba.conf from 98c8d4 to 40e348
gitlab-web-1  |       --- /var/opt/gitlab/postgresql/data/pg_hba.conf   2022-07-28 06:56:54.113411791 +0000
gitlab-web-1  |       +++ /var/opt/gitlab/postgresql/data/.chef-pg_hba20220728-35-1c9defi.conf  2022-07-28 06:56:55.741453854 +0000
gitlab-web-1  |       @@ -1,98 +1,74 @@
gitlab-web-1  |       +# This file is managed by gitlab-ctl. Manual changes will be
gitlab-web-1  |       +# erased! To change the contents below, edit /etc/gitlab/gitlab.rb
gitlab-web-1  |       +# and run `sudo gitlab-ctl reconfigure`.
gitlab-web-1  |       +
gitlab-web-1  |        # PostgreSQL Client Authentication Configuration File
gitlab-web-1  |        # ===================================================
gitlab-web-1  |        #
gitlab-web-1  |       -# Refer to the "Client Authentication" section in the PostgreSQL
gitlab-web-1  |       -# documentation for a complete description of this file.  A short
gitlab-web-1  |       -# synopsis follows.
gitlab-web-1  |       +# Refer to the "Client Authentication" section in the
gitlab-web-1  |       +# PostgreSQL documentation for a complete description
gitlab-web-1  |       +# of this file.  A short synopsis follows.
gitlab-web-1  |        #
gitlab-web-1  |        # This file controls: which hosts are allowed to connect, how clients
gitlab-web-1  |        # are authenticated, which PostgreSQL user names they can use, which
gitlab-web-1  |        # databases they can access.  Records take one of these forms:
gitlab-web-1  |        #
gitlab-web-1  |       -# local         DATABASE  USER  METHOD  [OPTIONS]
gitlab-web-1  |       -# host          DATABASE  USER  ADDRESS  METHOD  [OPTIONS]
gitlab-web-1  |       -# hostssl       DATABASE  USER  ADDRESS  METHOD  [OPTIONS]
gitlab-web-1  |       -# hostnossl     DATABASE  USER  ADDRESS  METHOD  [OPTIONS]
gitlab-web-1  |       -# hostgssenc    DATABASE  USER  ADDRESS  METHOD  [OPTIONS]
gitlab-web-1  |       -# hostnogssenc  DATABASE  USER  ADDRESS  METHOD  [OPTIONS]
gitlab-web-1  |       +# local      DATABASE  USER  METHOD  [OPTION]
gitlab-web-1  |       +# host       DATABASE  USER  CIDR-ADDRESS  METHOD  [OPTION]
gitlab-web-1  |       +# hostssl    DATABASE  USER  CIDR-ADDRESS  METHOD  [OPTION]
gitlab-web-1  |       +# hostnossl  DATABASE  USER  CIDR-ADDRESS  METHOD  [OPTION]
gitlab-web-1  |        #
gitlab-web-1  |        # (The uppercase items must be replaced by actual values.)
gitlab-web-1  |        #
gitlab-web-1  |       -# The first field is the connection type: "local" is a Unix-domain
gitlab-web-1  |       -# socket, "host" is either a plain or SSL-encrypted TCP/IP socket,
gitlab-web-1  |       -# "hostssl" is an SSL-encrypted TCP/IP socket, and "hostnossl" is a
gitlab-web-1  |       -# non-SSL TCP/IP socket.  Similarly, "hostgssenc" uses a
gitlab-web-1  |       -# GSSAPI-encrypted TCP/IP socket, while "hostnogssenc" uses a
gitlab-web-1  |       -# non-GSSAPI socket.
gitlab-web-1  |       +# The first field is the connection type: "local" is a Unix-domain socket,
gitlab-web-1  |       +# "host" is either a plain or SSL-encrypted TCP/IP socket, "hostssl" is an
gitlab-web-1  |       +# SSL-encrypted TCP/IP socket, and "hostnossl" is a plain TCP/IP socket.
gitlab-web-1  |        #
gitlab-web-1  |       -# DATABASE can be "all", "sameuser", "samerole", "replication", a
gitlab-web-1  |       -# database name, or a comma-separated list thereof. The "all"
gitlab-web-1  |       -# keyword does not match "replication". Access to replication
gitlab-web-1  |       -# must be enabled in a separate record (see example below).
gitlab-web-1  |       +# DATABASE can be "all", "sameuser", "samerole", a database name, or
gitlab-web-1  |       +# a comma-separated list thereof.
gitlab-web-1  |        #
gitlab-web-1  |       -# USER can be "all", a user name, a group name prefixed with "+", or a
gitlab-web-1  |       -# comma-separated list thereof.  In both the DATABASE and USER fields
gitlab-web-1  |       -# you can also write a file name prefixed with "@" to include names
gitlab-web-1  |       -# from a separate file.
gitlab-web-1  |       +# USER can be "all", a user name, a group name prefixed with "+", or
gitlab-web-1  |       +# a comma-separated list thereof.  In both the DATABASE and USER fields
gitlab-web-1  |       +# you can also write a file name prefixed with "@" to include names from
gitlab-web-1  |       +# a separate file.
gitlab-web-1  |        #
gitlab-web-1  |       -# ADDRESS specifies the set of hosts the record matches.  It can be a
gitlab-web-1  |       -# host name, or it is made up of an IP address and a CIDR mask that is
gitlab-web-1  |       -# an integer (between 0 and 32 (IPv4) or 128 (IPv6) inclusive) that
gitlab-web-1  |       -# specifies the number of significant bits in the mask.  A host name
gitlab-web-1  |       -# that starts with a dot (.) matches a suffix of the actual host name.
gitlab-web-1  |       -# Alternatively, you can write an IP address and netmask in separate
gitlab-web-1  |       -# columns to specify the set of hosts.  Instead of a CIDR-address, you
gitlab-web-1  |       -# can write "samehost" to match any of the server's own IP addresses,
gitlab-web-1  |       -# or "samenet" to match any address in any subnet that the server is
gitlab-web-1  |       -# directly connected to.
gitlab-web-1  |       +# CIDR-ADDRESS specifies the set of hosts the record matches.
gitlab-web-1  |       +# It is made up of an IP address and a CIDR mask that is an integer
gitlab-web-1  |       +# (between 0 and 32 (IPv4) or 128 (IPv6) inclusive) that specifies
gitlab-web-1  |       +# the number of significant bits in the mask.  Alternatively, you can write
gitlab-web-1  |       +# an IP address and netmask in separate columns to specify the set of hosts.
gitlab-web-1  |        #
gitlab-web-1  |       -# METHOD can be "trust", "reject", "md5", "password", "scram-sha-256",
gitlab-web-1  |       -# "gss", "sspi", "ident", "peer", "pam", "ldap", "radius" or "cert".
gitlab-web-1  |       -# Note that "password" sends passwords in clear text; "md5" or
gitlab-web-1  |       -# "scram-sha-256" are preferred since they send encrypted passwords.
gitlab-web-1  |       +# METHOD can be "trust", "reject", "md5", "crypt", "password", "gss", "sspi",
gitlab-web-1  |       +# "krb5", "ident", "pam" or "ldap".  Note that "password" sends passwords
gitlab-web-1  |       +# in clear text; "md5" is preferred since it sends encrypted passwords.
gitlab-web-1  |        #
gitlab-web-1  |       -# OPTIONS are a set of options for the authentication in the format
gitlab-web-1  |       -# NAME=VALUE.  The available options depend on the different
gitlab-web-1  |       -# authentication methods -- refer to the "Client Authentication"
gitlab-web-1  |       -# section in the documentation for a list of which options are
gitlab-web-1  |       -# available for which authentication methods.
gitlab-web-1  |       +# OPTION is the ident map or the name of the PAM service, depending on METHOD.
gitlab-web-1  |        #
gitlab-web-1  |       -# Database and user names containing spaces, commas, quotes and other
gitlab-web-1  |       -# special characters must be quoted.  Quoting one of the keywords
gitlab-web-1  |       -# "all", "sameuser", "samerole" or "replication" makes the name lose
gitlab-web-1  |       -# its special character, and just match a database or username with
gitlab-web-1  |       -# that name.
gitlab-web-1  |       +# Database and user names containing spaces, commas, quotes and other special
gitlab-web-1  |       +# characters must be quoted. Quoting one of the keywords "all", "sameuser" or
gitlab-web-1  |       +# "samerole" makes the name lose its special character, and just match a
gitlab-web-1  |       +# database or username with that name.
gitlab-web-1  |        #
gitlab-web-1  |       -# This file is read on server startup and when the server receives a
gitlab-web-1  |       -# SIGHUP signal.  If you edit the file on a running system, you have to
gitlab-web-1  |       -# SIGHUP the server for the changes to take effect, run "pg_ctl reload",
gitlab-web-1  |       -# or execute "SELECT pg_reload_conf()".
gitlab-web-1  |       -#
gitlab-web-1  |       +# This file is read on server startup and when the postmaster receives
gitlab-web-1  |       +# a SIGHUP signal.  If you edit the file on a running system, you have
gitlab-web-1  |       +# to SIGHUP the postmaster for the changes to take effect.  You can use
gitlab-web-1  |       +# "pg_ctl reload" to do that.
gitlab-web-1  |       +
gitlab-web-1  |        # Put your actual configuration here
gitlab-web-1  |        # ----------------------------------
gitlab-web-1  |        #
gitlab-web-1  |        # If you want to allow non-local connections, you need to add more
gitlab-web-1  |       -# "host" records.  In that case you will also need to make PostgreSQL
gitlab-web-1  |       -# listen on a non-local interface via the listen_addresses
gitlab-web-1  |       -# configuration parameter, or via the -i or -h command line switches.
gitlab-web-1  |       +# "host" records. In that case you will also need to make PostgreSQL listen
gitlab-web-1  |       +# on a non-local interface via the listen_addresses configuration parameter,
gitlab-web-1  |       +# or via the -i or -h command line switches.
gitlab-web-1  |       +#
gitlab-web-1  |
gitlab-web-1  |       -# CAUTION: Configuring the system for local "trust" authentication
gitlab-web-1  |       -# allows any local user to connect as any PostgreSQL user, including
gitlab-web-1  |       -# the database superuser.  If you do not trust all your local users,
gitlab-web-1  |       -# use another authentication method.
gitlab-web-1  |
gitlab-web-1  |       +# TYPE  DATABASE    USER        CIDR-ADDRESS          METHOD
gitlab-web-1  |
gitlab-web-1  |       -# TYPE  DATABASE        USER            ADDRESS                 METHOD
gitlab-web-1  |       -
gitlab-web-1  |        # "local" is for Unix domain socket connections only
gitlab-web-1  |       -local   all             all                                     trust
gitlab-web-1  |       -# IPv4 local connections:
gitlab-web-1  |       -host    all             all             127.0.0.1/32            trust
gitlab-web-1  |       -# IPv6 local connections:
gitlab-web-1  |       -host    all             all             ::1/128                 trust
gitlab-web-1  |       -# Allow replication connections from localhost, by a user with the
gitlab-web-1  |       -# replication privilege.
gitlab-web-1  |       -local   replication     all                                     trust
gitlab-web-1  |       -host    replication     all             127.0.0.1/32            trust
gitlab-web-1  |       -host    replication     all             ::1/128                 trust
gitlab-web-1  |       +local   all         all                               peer map=gitlab
gitlab-web-1  |       +
gitlab-web-1  |       +
gitlab-web-1  |       +
gitlab-web-1  |       - change mode from '0600' to '0644'
gitlab-web-1  |     * template[/var/opt/gitlab/postgresql/data/pg_ident.conf] action create
gitlab-web-1  |       - update content in file /var/opt/gitlab/postgresql/data/pg_ident.conf from 297f46 to 5399a1
gitlab-web-1  |       --- /var/opt/gitlab/postgresql/data/pg_ident.conf 2022-07-28 06:56:54.113411791 +0000
gitlab-web-1  |       +++ /var/opt/gitlab/postgresql/data/.chef-pg_ident20220728-35-1ib3xlp.conf        2022-07-28 06:56:55.777454784 +0000
gitlab-web-1  |       @@ -40,4 +40,8 @@
gitlab-web-1  |        # ----------------------------------
gitlab-web-1  |
gitlab-web-1  |        # MAPNAME       SYSTEM-USERNAME         PG-USERNAME
gitlab-web-1  |       +gitlab  git  gitlab
gitlab-web-1  |       +gitlab  mattermost  gitlab_mattermost
gitlab-web-1  |       +# Default to a 1-1 mapping between system usernames and Postgres usernames
gitlab-web-1  |       +gitlab  /^(.*)$  \1
gitlab-web-1  |       - change mode from '0600' to '0644'
gitlab-web-1  |
gitlab-web-1  | Recipe: postgresql::standalone
gitlab-web-1  |   * service[postgresql] action nothing (skipped due to action :nothing)
gitlab-web-1  |   * runit_service[postgresql] action enable
gitlab-web-1  |     * ruby_block[restart_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * directory[/opt/gitlab/sv/postgresql] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/postgresql
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * template[/opt/gitlab/sv/postgresql/run] action create
gitlab-web-1  |       - create new file /opt/gitlab/sv/postgresql/run
gitlab-web-1  |       - update content in file /opt/gitlab/sv/postgresql/run from none to dc5689
gitlab-web-1  |       --- /opt/gitlab/sv/postgresql/run 2022-07-28 06:56:55.825456025 +0000
gitlab-web-1  |       +++ /opt/gitlab/sv/postgresql/.chef-run20220728-35-1bkrz3e        2022-07-28 06:56:55.825456025 +0000
gitlab-web-1  |       @@ -1 +1,5 @@
gitlab-web-1  |       +#!/bin/sh
gitlab-web-1  |       +exec 2>&1
gitlab-web-1  |       +
gitlab-web-1  |       +exec chpst -P -U gitlab-psql:gitlab-psql -u gitlab-psql:gitlab-psql /opt/gitlab/embedded/bin/postgres -D /var/opt/gitlab/postgresql/data
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * directory[/opt/gitlab/sv/postgresql/log] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/postgresql/log
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * directory[/opt/gitlab/sv/postgresql/log/main] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/postgresql/log/main
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * template[/opt/gitlab/sv/postgresql/log/config] action create
gitlab-web-1  |       - create new file /opt/gitlab/sv/postgresql/log/config
gitlab-web-1  |       - update content in file /opt/gitlab/sv/postgresql/log/config from none to 623c00
gitlab-web-1  |       --- /opt/gitlab/sv/postgresql/log/config  2022-07-28 06:56:55.857456852 +0000
gitlab-web-1  |       +++ /opt/gitlab/sv/postgresql/log/.chef-config20220728-35-1iu1eep 2022-07-28 06:56:55.857456852 +0000
gitlab-web-1  |       @@ -1 +1,7 @@
gitlab-web-1  |       +s209715200
gitlab-web-1  |       +n30
gitlab-web-1  |       +t86400
gitlab-web-1  |       +!gzip
gitlab-web-1  |       +
gitlab-web-1  |       +
gitlab-web-1  |       - change mode from '' to '0644'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * ruby_block[verify_chown_persisted_on_postgresql] action create
gitlab-web-1  |       - execute the ruby block verify_chown_persisted_on_postgresql
gitlab-web-1  |     * ruby_block[verify_chown_persisted_on_postgresql] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * link[/var/log/gitlab/postgresql/config] action create
gitlab-web-1  |       - create symlink at /var/log/gitlab/postgresql/config to /opt/gitlab/sv/postgresql/log/config
gitlab-web-1  |     * template[/opt/gitlab/sv/postgresql/log/run] action create
gitlab-web-1  |       - create new file /opt/gitlab/sv/postgresql/log/run
gitlab-web-1  |       - update content in file /opt/gitlab/sv/postgresql/log/run from none to ce742a
gitlab-web-1  |       --- /opt/gitlab/sv/postgresql/log/run     2022-07-28 06:56:55.885457575 +0000
gitlab-web-1  |       +++ /opt/gitlab/sv/postgresql/log/.chef-run20220728-35-1986hem    2022-07-28 06:56:55.885457575 +0000
gitlab-web-1  |       @@ -1 +1,3 @@
gitlab-web-1  |       +#!/bin/sh
gitlab-web-1  |       +exec svlogd -tt /var/log/gitlab/postgresql
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * directory[/opt/gitlab/sv/postgresql/env] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/postgresql/env
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * ruby_block[Delete unmanaged env files for postgresql service] action run (skipped due to only_if)
gitlab-web-1  |     * template[/opt/gitlab/sv/postgresql/check] action create (skipped due to only_if)
gitlab-web-1  |     * template[/opt/gitlab/sv/postgresql/finish] action create (skipped due to only_if)
gitlab-web-1  |     * directory[/opt/gitlab/sv/postgresql/control] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/postgresql/control
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * template[/opt/gitlab/sv/postgresql/control/t] action create
gitlab-web-1  |       - create new file /opt/gitlab/sv/postgresql/control/t
gitlab-web-1  |       - update content in file /opt/gitlab/sv/postgresql/control/t from none to 05ae12
gitlab-web-1  |       --- /opt/gitlab/sv/postgresql/control/t   2022-07-28 06:56:55.921458505 +0000
gitlab-web-1  |       +++ /opt/gitlab/sv/postgresql/control/.chef-t20220728-35-1t6u1kw  2022-07-28 06:56:55.921458505 +0000
gitlab-web-1  |       @@ -1 +1,4 @@
gitlab-web-1  |       +#!/bin/sh
gitlab-web-1  |       +echo "received TERM from runit, sending INT instead to force quit connections"
gitlab-web-1  |       +/opt/gitlab/embedded/bin/sv interrupt postgresql
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * link[/opt/gitlab/init/postgresql] action create
gitlab-web-1  |       - create symlink at /opt/gitlab/init/postgresql to /opt/gitlab/embedded/bin/sv
gitlab-web-1  |     * file[/opt/gitlab/sv/postgresql/down] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * ruby_block[restart_service] action run (skipped due to only_if)
gitlab-web-1  |     * ruby_block[reload_log_service] action create
gitlab-web-1  |       * ruby_block[restart_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/sv/postgresql] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/postgresql/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/postgresql/log] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/postgresql/log/main] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/postgresql/log/config] action create (up to date)
gitlab-web-1  |       * ruby_block[verify_chown_persisted_on_postgresql] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * link[/var/log/gitlab/postgresql/config] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/postgresql/log/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/postgresql/env] action create (up to date)
gitlab-web-1  |       * ruby_block[Delete unmanaged env files for postgresql service] action run (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/postgresql/check] action create (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/postgresql/finish] action create (skipped due to only_if)
gitlab-web-1  |       * directory[/opt/gitlab/sv/postgresql/control] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/postgresql/control/t] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/init/postgresql] action create (up to date)
gitlab-web-1  |       * file[/opt/gitlab/sv/postgresql/down] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/service] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/service/postgresql] action create
gitlab-web-1  |         - create symlink at /opt/gitlab/service/postgresql to /opt/gitlab/sv/postgresql
gitlab-web-1  |       * ruby_block[wait for postgresql service socket] action run
gitlab-web-1  |         - execute the ruby block wait for postgresql service socket
gitlab-web-1  |       * directory[/opt/gitlab/service/postgresql/supervise] action create
gitlab-web-1  |         - change mode from '0700' to '0755'
gitlab-web-1  |       * directory[/opt/gitlab/service/postgresql/log/supervise] action create
gitlab-web-1  |         - change mode from '0700' to '0755'
gitlab-web-1  |       * file[/opt/gitlab/service/postgresql/supervise/ok] action touch
gitlab-web-1  |         - create new file /opt/gitlab/service/postgresql/supervise/ok
gitlab-web-1  |         - change owner from '' to 'gitlab-psql'
gitlab-web-1  |         - change group from '' to 'gitlab-psql'
gitlab-web-1  |         - update utime on file /opt/gitlab/service/postgresql/supervise/ok
gitlab-web-1  |       * file[/opt/gitlab/service/postgresql/log/supervise/ok] action touch
gitlab-web-1  |         - create new file /opt/gitlab/service/postgresql/log/supervise/ok
gitlab-web-1  |         - change owner from '' to 'gitlab-psql'
gitlab-web-1  |         - change group from '' to 'gitlab-psql'
gitlab-web-1  |         - update utime on file /opt/gitlab/service/postgresql/log/supervise/ok
gitlab-web-1  |       * file[/opt/gitlab/service/postgresql/supervise/status] action touch
gitlab-web-1  |         - change owner from 'root' to 'gitlab-psql'
gitlab-web-1  |         - change group from 'root' to 'gitlab-psql'
gitlab-web-1  |         - update utime on file /opt/gitlab/service/postgresql/supervise/status
gitlab-web-1  |       * file[/opt/gitlab/service/postgresql/log/supervise/status] action touch
gitlab-web-1  |         - change owner from 'root' to 'gitlab-psql'
gitlab-web-1  |         - change group from 'root' to 'gitlab-psql'
gitlab-web-1  |         - update utime on file /opt/gitlab/service/postgresql/log/supervise/status
gitlab-web-1  |       * file[/opt/gitlab/service/postgresql/supervise/control] action touch
gitlab-web-1  |         - create new file /opt/gitlab/service/postgresql/supervise/control
gitlab-web-1  |         - change owner from '' to 'gitlab-psql'
gitlab-web-1  |         - change group from '' to 'gitlab-psql'
gitlab-web-1  |         - update utime on file /opt/gitlab/service/postgresql/supervise/control
gitlab-web-1  |       * file[/opt/gitlab/service/postgresql/log/supervise/control] action touch
gitlab-web-1  |         - create new file /opt/gitlab/service/postgresql/log/supervise/control
gitlab-web-1  |         - change owner from '' to 'gitlab-psql'
gitlab-web-1  |         - change group from '' to 'gitlab-psql'
gitlab-web-1  |         - update utime on file /opt/gitlab/service/postgresql/log/supervise/control
gitlab-web-1  |       - execute the ruby block reload_log_service
gitlab-web-1  |     * ruby_block[restart_log_service] action run
gitlab-web-1  |       * ruby_block[restart_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/sv/postgresql] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/postgresql/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/postgresql/log] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/postgresql/log/main] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/postgresql/log/config] action create (up to date)
gitlab-web-1  |       * ruby_block[verify_chown_persisted_on_postgresql] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * link[/var/log/gitlab/postgresql/config] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/postgresql/log/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/postgresql/env] action create (up to date)
gitlab-web-1  |       * ruby_block[Delete unmanaged env files for postgresql service] action run (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/postgresql/check] action create (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/postgresql/finish] action create (skipped due to only_if)
gitlab-web-1  |       * directory[/opt/gitlab/sv/postgresql/control] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/postgresql/control/t] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/init/postgresql] action create (up to date)
gitlab-web-1  |       * file[/opt/gitlab/sv/postgresql/down] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/service] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/service/postgresql] action create (up to date)
gitlab-web-1  |       * ruby_block[wait for postgresql service socket] action run (skipped due to not_if)
gitlab-web-1  |       * directory[/opt/gitlab/service/postgresql/supervise] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/service/postgresql/log/supervise] action create (up to date)
gitlab-web-1  |       * file[/opt/gitlab/service/postgresql/supervise/ok] action touch (skipped due to only_if)
gitlab-web-1  |       * file[/opt/gitlab/service/postgresql/log/supervise/ok] action touch (skipped due to only_if)
gitlab-web-1  |       * file[/opt/gitlab/service/postgresql/supervise/status] action touch (skipped due to only_if)
gitlab-web-1  |       * file[/opt/gitlab/service/postgresql/log/supervise/status] action touch
gitlab-web-1  |         - change owner from 'root' to 'gitlab-psql'
gitlab-web-1  |         - change group from 'root' to 'gitlab-psql'
gitlab-web-1  |         - update utime on file /opt/gitlab/service/postgresql/log/supervise/status
gitlab-web-1  |       * file[/opt/gitlab/service/postgresql/supervise/control] action touch (skipped due to only_if)
gitlab-web-1  |       * file[/opt/gitlab/service/postgresql/log/supervise/control] action touch (skipped due to only_if)
gitlab-web-1  |       - execute the ruby block restart_log_service
gitlab-web-1  |     * directory[/opt/gitlab/service] action create (up to date)
gitlab-web-1  |     * link[/opt/gitlab/service/postgresql] action create (up to date)
gitlab-web-1  |     * ruby_block[wait for postgresql service socket] action run (skipped due to not_if)
gitlab-web-1  |     * directory[/opt/gitlab/service/postgresql/supervise] action create (up to date)
gitlab-web-1  |     * directory[/opt/gitlab/service/postgresql/log/supervise] action create (up to date)
gitlab-web-1  |     * file[/opt/gitlab/service/postgresql/supervise/ok] action touch (skipped due to only_if)
gitlab-web-1  |     * file[/opt/gitlab/service/postgresql/log/supervise/ok] action touch (skipped due to only_if)
gitlab-web-1  |     * file[/opt/gitlab/service/postgresql/supervise/status] action touch (skipped due to only_if)
gitlab-web-1  |     * file[/opt/gitlab/service/postgresql/log/supervise/status] action touch
gitlab-web-1  |       - change owner from 'root' to 'gitlab-psql'
gitlab-web-1  |       - change group from 'root' to 'gitlab-psql'
gitlab-web-1  |       - update utime on file /opt/gitlab/service/postgresql/log/supervise/status
gitlab-web-1  |     * file[/opt/gitlab/service/postgresql/supervise/control] action touch (skipped due to only_if)
gitlab-web-1  |     * file[/opt/gitlab/service/postgresql/log/supervise/control] action touch (skipped due to only_if)
gitlab-web-1  |
gitlab-web-1  |   * execute[/opt/gitlab/bin/gitlab-ctl start postgresql] action run
gitlab-web-1  |     [execute] ok: run: postgresql: (pid 592) 6s
gitlab-web-1  |     - execute /opt/gitlab/bin/gitlab-ctl start postgresql
gitlab-web-1  |   * database_objects[postgresql] action create
gitlab-web-1  |     * postgresql_user[gitlab] action create
gitlab-web-1  |       * execute[create gitlab postgresql user] action run
gitlab-web-1  |         [execute] CREATE ROLE
gitlab-web-1  |         - execute /opt/gitlab/bin/gitlab-psql -d template1 -c "CREATE USER \"gitlab\""
gitlab-web-1  |
gitlab-web-1  |     * postgresql_user[gitlab_replicator] action create
gitlab-web-1  |       * execute[create gitlab_replicator postgresql user] action run
gitlab-web-1  |         [execute] CREATE ROLE
gitlab-web-1  |         - execute /opt/gitlab/bin/gitlab-psql -d template1 -c "CREATE USER \"gitlab_replicator\""
gitlab-web-1  |       * execute[set options for gitlab_replicator postgresql user] action run
gitlab-web-1  |         [execute] ALTER ROLE
gitlab-web-1  |         - execute /opt/gitlab/bin/gitlab-psql -d template1 -c "ALTER USER \"gitlab_replicator\" replication"
gitlab-web-1  |
gitlab-web-1  |     * postgresql_database[gitlabhq_production] action create
gitlab-web-1  |       * execute[create database gitlabhq_production] action run
gitlab-web-1  |         - execute /opt/gitlab/embedded/bin/createdb --port 5432 -h /var/opt/gitlab/postgresql -O gitlab gitlabhq_production
gitlab-web-1  |
gitlab-web-1  |     * postgresql_extension[pg_trgm] action enable
gitlab-web-1  |       * postgresql_query[enable pg_trgm extension] action run
gitlab-web-1  |         * execute[enable pg_trgm extension (postgresql)] action run
gitlab-web-1  |           [execute] CREATE EXTENSION
gitlab-web-1  |           - execute /opt/gitlab/bin/gitlab-psql -d gitlabhq_production -c "CREATE EXTENSION IF NOT EXISTS pg_trgm"
gitlab-web-1  |
gitlab-web-1  |
gitlab-web-1  |     * postgresql_extension[btree_gist] action enable
gitlab-web-1  |       * postgresql_query[enable btree_gist extension] action run
gitlab-web-1  |         * execute[enable btree_gist extension (postgresql)] action run
gitlab-web-1  |           [execute] CREATE EXTENSION
gitlab-web-1  |           - execute /opt/gitlab/bin/gitlab-psql -d gitlabhq_production -c "CREATE EXTENSION IF NOT EXISTS btree_gist"
gitlab-web-1  |
gitlab-web-1  |
gitlab-web-1  |
gitlab-web-1  |   * ruby_block[warn pending postgresql restart] action run (skipped due to only_if)
gitlab-web-1  |   * execute[reload postgresql] action nothing (skipped due to action :nothing)
gitlab-web-1  |   * execute[start postgresql] action nothing (skipped due to action :nothing)
gitlab-web-1  | Recipe: praefect::disable
gitlab-web-1  |   * service[praefect] action nothing (skipped due to action :nothing)
gitlab-web-1  |   * runit_service[praefect] action disable
gitlab-web-1  |     * ruby_block[disable praefect] action run (skipped due to only_if)
gitlab-web-1  |      (up to date)
gitlab-web-1  |   * consul_service[praefect] action delete
gitlab-web-1  |     * file[/var/opt/gitlab/consul/config.d/praefect-service.json] action delete (up to date)
gitlab-web-1  |      (up to date)
gitlab-web-1  | Recipe: gitlab-kas::enable
gitlab-web-1  |   * directory[/var/opt/gitlab/gitlab-kas] action create
gitlab-web-1  |     - create new directory /var/opt/gitlab/gitlab-kas
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |   * directory[/var/log/gitlab/gitlab-kas] action create
gitlab-web-1  |     - create new directory /var/log/gitlab/gitlab-kas
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |   * directory[/opt/gitlab/etc/gitlab-kas] action create
gitlab-web-1  |     - create new directory /opt/gitlab/etc/gitlab-kas
gitlab-web-1  |     - change mode from '' to '0700'
gitlab-web-1  |     - change owner from '' to 'git'
gitlab-web-1  |   * ruby_block[websocket TLS termination] action run (skipped due to only_if)
gitlab-web-1  |   * version_file[Create version file for Gitlab KAS] action create
gitlab-web-1  |     * file[/var/opt/gitlab/gitlab-kas/VERSION] action create
gitlab-web-1  |       - create new file /var/opt/gitlab/gitlab-kas/VERSION
gitlab-web-1  |       - update content in file /var/opt/gitlab/gitlab-kas/VERSION from none to 74ef68
gitlab-web-1  |       --- /var/opt/gitlab/gitlab-kas/VERSION    2022-07-28 06:57:08.101773209 +0000
gitlab-web-1  |       +++ /var/opt/gitlab/gitlab-kas/.chef-VERSION20220728-35-1d0o04q   2022-07-28 06:57:08.101773209 +0000
gitlab-web-1  |       @@ -1 +1,2 @@
gitlab-web-1  |       +kas version v14.10.0, commit: aa11a94, built: 20220601.144847
gitlab-web-1  |
gitlab-web-1  |   * file[/var/opt/gitlab/gitlab-kas/authentication_secret_file] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/gitlab-kas/authentication_secret_file
gitlab-web-1  |     - update content in file /var/opt/gitlab/gitlab-kas/authentication_secret_file from none to d7a8b0
gitlab-web-1  |     --- /var/opt/gitlab/gitlab-kas/authentication_secret_file   2022-07-28 06:57:08.125773829 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/gitlab-kas/.chef-authentication_secret_file20220728-35-sy7xkp   2022-07-28 06:57:08.125773829 +0000
gitlab-web-1  |     @@ -1 +1,2 @@
gitlab-web-1  |     +ZDJkODRhNjAxNWUzMjc2NTQ0NzY3OGFiYWU3OTVmZGM=
gitlab-web-1  |     - change mode from '' to '0640'
gitlab-web-1  |     - change owner from '' to 'root'
gitlab-web-1  |     - change group from '' to 'git'
gitlab-web-1  |   * file[/var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file
gitlab-web-1  |     - update content in file /var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file from none to fd704e
gitlab-web-1  |     --- /var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file       2022-07-28 06:57:08.149774449 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/gitlab-kas/.chef-private_api_authentication_secret_file20220728-35-1edsfn9      2022-07-28 06:57:08.149774449 +0000
gitlab-web-1  |     @@ -1 +1,2 @@
gitlab-web-1  |     +NTRhODE5NjU4ZTcxMjYwMjQ1ZjhjYThkMmUzNGYzYjc=
gitlab-web-1  |     - change mode from '' to '0640'
gitlab-web-1  |     - change owner from '' to 'root'
gitlab-web-1  |     - change group from '' to 'git'
gitlab-web-1  |   * file[/var/opt/gitlab/gitlab-kas/redis_password_file] action create (skipped due to only_if)
gitlab-web-1  |   * template[/var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml] action create
gitlab-web-1  |     - create new file /var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml
gitlab-web-1  |     - update content in file /var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml from none to 4e9852
gitlab-web-1  |     --- /var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml        2022-07-28 06:57:08.181775276 +0000
gitlab-web-1  |     +++ /var/opt/gitlab/gitlab-kas/.chef-gitlab-kas-config20220728-35-vs24he.yml        2022-07-28 06:57:08.181775276 +0000
gitlab-web-1  |     @@ -1 +1,41 @@
gitlab-web-1  |     +agent:
gitlab-web-1  |     +  listen:
gitlab-web-1  |     +    address: localhost:8150
gitlab-web-1  |     +    network: tcp
gitlab-web-1  |     +    websocket: true
gitlab-web-1  |     +  configuration:
gitlab-web-1  |     +    poll_period: 20s
gitlab-web-1  |     +  gitops:
gitlab-web-1  |     +    poll_period: 20s
gitlab-web-1  |     +    project_info_cache_ttl: 300s
gitlab-web-1  |     +    project_info_cache_error_ttl: 60s
gitlab-web-1  |     +  kubernetes_api:
gitlab-web-1  |     +    listen:
gitlab-web-1  |     +      address: localhost:8154
gitlab-web-1  |     +    url_path_prefix: /
gitlab-web-1  |     +  info_cache_ttl: 300s
gitlab-web-1  |     +  info_cache_error_ttl: 60s
gitlab-web-1  |     +gitlab:
gitlab-web-1  |     +  address: https://gitlab.example.com
gitlab-web-1  |     +  authentication_secret_file: /var/opt/gitlab/gitlab-kas/authentication_secret_file
gitlab-web-1  |     +observability:
gitlab-web-1  |     +  usage_reporting_period: 60s
gitlab-web-1  |     +  logging:
gitlab-web-1  |     +    level: info
gitlab-web-1  |     +redis:
gitlab-web-1  |     +  network: unix
gitlab-web-1  |     +  tls:
gitlab-web-1  |     +    enabled: false
gitlab-web-1  |     +  server:
gitlab-web-1  |     +    address: '/var/opt/gitlab/redis/redis.socket'
gitlab-web-1  |     +api:
gitlab-web-1  |     +  listen:
gitlab-web-1  |     +    network: tcp
gitlab-web-1  |     +    address: localhost:8153
gitlab-web-1  |     +    authentication_secret_file: /var/opt/gitlab/gitlab-kas/authentication_secret_file
gitlab-web-1  |     +private_api:
gitlab-web-1  |     +  listen:
gitlab-web-1  |     +    network: tcp
gitlab-web-1  |     +    address: localhost:8155
gitlab-web-1  |     +    authentication_secret_file: /var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file
gitlab-web-1  |     - change mode from '' to '0640'
gitlab-web-1  |     - change owner from '' to 'root'
gitlab-web-1  |     - change group from '' to 'git'
gitlab-web-1  |   * env_dir[/opt/gitlab/etc/gitlab-kas/env] action create
gitlab-web-1  |     * directory[/opt/gitlab/etc/gitlab-kas/env] action create
gitlab-web-1  |       - create new directory /opt/gitlab/etc/gitlab-kas/env
gitlab-web-1  |     * file[/opt/gitlab/etc/gitlab-kas/env/SSL_CERT_DIR] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitlab-kas/env/SSL_CERT_DIR
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitlab-kas/env/SSL_CERT_DIR from none to 4f45cf
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |     * file[/opt/gitlab/etc/gitlab-kas/env/OWN_PRIVATE_API_URL] action create
gitlab-web-1  |       - create new file /opt/gitlab/etc/gitlab-kas/env/OWN_PRIVATE_API_URL
gitlab-web-1  |       - update content in file /opt/gitlab/etc/gitlab-kas/env/OWN_PRIVATE_API_URL from none to 45b898
gitlab-web-1  |       - suppressed sensitive resource
gitlab-web-1  |
gitlab-web-1  |   * service[gitlab-kas] action nothing (skipped due to action :nothing)
gitlab-web-1  |   * runit_service[gitlab-kas] action enable
gitlab-web-1  |     * ruby_block[restart_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * directory[/opt/gitlab/sv/gitlab-kas] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/gitlab-kas
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * template[/opt/gitlab/sv/gitlab-kas/run] action create
gitlab-web-1  |       - create new file /opt/gitlab/sv/gitlab-kas/run
gitlab-web-1  |       - update content in file /opt/gitlab/sv/gitlab-kas/run from none to ac037b
gitlab-web-1  |       --- /opt/gitlab/sv/gitlab-kas/run 2022-07-28 06:57:08.337779306 +0000
gitlab-web-1  |       +++ /opt/gitlab/sv/gitlab-kas/.chef-run20220728-35-16qls5t        2022-07-28 06:57:08.337779306 +0000
gitlab-web-1  |       @@ -1 +1,12 @@
gitlab-web-1  |       +#!/bin/bash
gitlab-web-1  |       +
gitlab-web-1  |       +# Let runit capture all script error messages
gitlab-web-1  |       +exec 2>&1
gitlab-web-1  |       +
gitlab-web-1  |       +
gitlab-web-1  |       +
gitlab-web-1  |       +exec chpst -e /opt/gitlab/etc/gitlab-kas/env -P \
gitlab-web-1  |       +  -u git:git \
gitlab-web-1  |       +  -U git:git \
gitlab-web-1  |       +  /opt/gitlab/embedded/bin/gitlab-kas --configuration-file /var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * directory[/opt/gitlab/sv/gitlab-kas/log] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/gitlab-kas/log
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * directory[/opt/gitlab/sv/gitlab-kas/log/main] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/gitlab-kas/log/main
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * template[/opt/gitlab/sv/gitlab-kas/log/config] action create
gitlab-web-1  |       - create new file /opt/gitlab/sv/gitlab-kas/log/config
gitlab-web-1  |       - update content in file /opt/gitlab/sv/gitlab-kas/log/config from none to 623c00
gitlab-web-1  |       --- /opt/gitlab/sv/gitlab-kas/log/config  2022-07-28 06:57:08.397780857 +0000
gitlab-web-1  |       +++ /opt/gitlab/sv/gitlab-kas/log/.chef-config20220728-35-q89by2  2022-07-28 06:57:08.397780857 +0000
gitlab-web-1  |       @@ -1 +1,7 @@
gitlab-web-1  |       +s209715200
gitlab-web-1  |       +n30
gitlab-web-1  |       +t86400
gitlab-web-1  |       +!gzip
gitlab-web-1  |       +
gitlab-web-1  |       +
gitlab-web-1  |       - change mode from '' to '0644'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * ruby_block[verify_chown_persisted_on_gitlab-kas] action create
gitlab-web-1  |       - execute the ruby block verify_chown_persisted_on_gitlab-kas
gitlab-web-1  |     * ruby_block[verify_chown_persisted_on_gitlab-kas] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * link[/var/log/gitlab/gitlab-kas/config] action create
gitlab-web-1  |       - create symlink at /var/log/gitlab/gitlab-kas/config to /opt/gitlab/sv/gitlab-kas/log/config
gitlab-web-1  |     * template[/opt/gitlab/sv/gitlab-kas/log/run] action create
gitlab-web-1  |       - create new file /opt/gitlab/sv/gitlab-kas/log/run
gitlab-web-1  |       - update content in file /opt/gitlab/sv/gitlab-kas/log/run from none to cce1b7
gitlab-web-1  |       --- /opt/gitlab/sv/gitlab-kas/log/run     2022-07-28 06:57:08.433781787 +0000
gitlab-web-1  |       +++ /opt/gitlab/sv/gitlab-kas/log/.chef-run20220728-35-lb1i6s     2022-07-28 06:57:08.433781787 +0000
gitlab-web-1  |       @@ -1 +1,3 @@
gitlab-web-1  |       +#!/bin/sh
gitlab-web-1  |       +exec svlogd -tt /var/log/gitlab/gitlab-kas
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * directory[/opt/gitlab/sv/gitlab-kas/env] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/gitlab-kas/env
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * ruby_block[Delete unmanaged env files for gitlab-kas service] action run (skipped due to only_if)
gitlab-web-1  |     * template[/opt/gitlab/sv/gitlab-kas/check] action create (skipped due to only_if)
gitlab-web-1  |     * template[/opt/gitlab/sv/gitlab-kas/finish] action create (skipped due to only_if)
gitlab-web-1  |     * directory[/opt/gitlab/sv/gitlab-kas/control] action create
gitlab-web-1  |       - create new directory /opt/gitlab/sv/gitlab-kas/control
gitlab-web-1  |       - change mode from '' to '0755'
gitlab-web-1  |       - change owner from '' to 'root'
gitlab-web-1  |       - change group from '' to 'root'
gitlab-web-1  |     * link[/opt/gitlab/init/gitlab-kas] action create
gitlab-web-1  |       - create symlink at /opt/gitlab/init/gitlab-kas to /opt/gitlab/embedded/bin/sv
gitlab-web-1  |     * file[/opt/gitlab/sv/gitlab-kas/down] action nothing (skipped due to action :nothing)
gitlab-web-1  |     * ruby_block[restart_service] action run (skipped due to only_if)
gitlab-web-1  |     * ruby_block[reload_log_service] action create
gitlab-web-1  |       * ruby_block[restart_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitlab-kas] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitlab-kas/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitlab-kas/log] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitlab-kas/log/main] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitlab-kas/log/config] action create (up to date)
gitlab-web-1  |       * ruby_block[verify_chown_persisted_on_gitlab-kas] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * link[/var/log/gitlab/gitlab-kas/config] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitlab-kas/log/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitlab-kas/env] action create (up to date)
gitlab-web-1  |       * ruby_block[Delete unmanaged env files for gitlab-kas service] action run (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitlab-kas/check] action create (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitlab-kas/finish] action create (skipped due to only_if)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitlab-kas/control] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/init/gitlab-kas] action create (up to date)
gitlab-web-1  |       * file[/opt/gitlab/sv/gitlab-kas/down] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/service] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/service/gitlab-kas] action create
gitlab-web-1  |         - create symlink at /opt/gitlab/service/gitlab-kas to /opt/gitlab/sv/gitlab-kas
gitlab-web-1  |       * ruby_block[wait for gitlab-kas service socket] action run
gitlab-web-1  |         - execute the ruby block wait for gitlab-kas service socket
gitlab-web-1  |       - execute the ruby block reload_log_service
gitlab-web-1  |     * ruby_block[restart_log_service] action run
gitlab-web-1  |       * ruby_block[restart_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitlab-kas] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitlab-kas/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitlab-kas/log] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitlab-kas/log/main] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitlab-kas/log/config] action create (up to date)
gitlab-web-1  |       * ruby_block[verify_chown_persisted_on_gitlab-kas] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * link[/var/log/gitlab/gitlab-kas/config] action create (up to date)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitlab-kas/log/run] action create (up to date)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitlab-kas/env] action create (up to date)
gitlab-web-1  |       * ruby_block[Delete unmanaged env files for gitlab-kas service] action run (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitlab-kas/check] action create (skipped due to only_if)
gitlab-web-1  |       * template[/opt/gitlab/sv/gitlab-kas/finish] action create (skipped due to only_if)
gitlab-web-1  |       * directory[/opt/gitlab/sv/gitlab-kas/control] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/init/gitlab-kas] action create (up to date)
gitlab-web-1  |       * file[/opt/gitlab/sv/gitlab-kas/down] action nothing (skipped due to action :nothing)
gitlab-web-1  |       * directory[/opt/gitlab/service] action create (up to date)
gitlab-web-1  |       * link[/opt/gitlab/service/gitlab-kas] action create (up to date)
gitlab-web-1  |       * ruby_block[wait for gitlab-kas service socket] action run (skipped due to not_if)
gitlab-web-1  |       - execute the ruby block restart_log_service
gitlab-web-1  |     * directory[/opt/gitlab/service] action create (up to date)
gitlab-web-1  |     * link[/opt/gitlab/service/gitlab-kas] action create (up to date)
gitlab-web-1  |     * ruby_block[wait for gitlab-kas service socket] action run (skipped due to not_if)
gitlab-web-1  |
gitlab-web-1  | Recipe: gitlab::database_migrations
gitlab-web-1  |   * ruby_block[check remote PG version] action nothing (skipped due to action :nothing)
gitlab-web-1  |   * rails_migration[gitlab-rails] action run